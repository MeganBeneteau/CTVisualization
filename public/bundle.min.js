'use strict';

/* App Module */

var phonecatApp = angular.module('svalbardApp', [
  'ngRoute',
  'svalbardMain',
]);

phonecatApp.config(['$routeProvider',
  function($routeProvider) {
    $routeProvider.
      when('/', {
        templateUrl: 'components/Main/main.html',
        controller: 'MainController'
      }).
      otherwise({
        redirectTo: '/'
      });
  }]);


var container;

var camera, scene, renderer;
var cameraCube, sceneCube;

var mesh, lightMesh, geometry;
var spheres = [];

var directionalLight, pointLight;

var mouseX = 0;
var mouseY = 0;

var rx = 5000;
var ry = 5000;

var windowHalfX = 640 / 2;
var windowHalfY = 480 / 2;


function init() {

  container = $('#main');

  camera = new THREE.PerspectiveCamera( 60, 640/480, 1, 100000 );
  camera.position.z = 3200;

  cameraCube = new THREE.PerspectiveCamera( 60, 640/480, 1, 100000 );

  scene = new THREE.Scene();
  sceneCube = new THREE.Scene();

  var geometry = new THREE.SphereBufferGeometry( 100, 32, 16 );

  var path = "assets/images/pisa/";
  var format = '.png';
  var urls = [
    path + 'px' + format, path + 'nx' + format,
    path + 'py' + format, path + 'ny' + format,
    path + 'pz' + format, path + 'nz' + format
  ];

  var textureCube = new THREE.CubeTextureLoader().load( urls );
  var material = new THREE.MeshBasicMaterial( { color: 0xffffff, envMap: textureCube } );

  for ( var i = 0; i < 500; i ++ ) {

    var mesh = new THREE.Mesh( geometry, material );

    mesh.position.x = Math.random() * 10000 - 5000;
    mesh.position.y = Math.random() * 10000 - 5000;
    mesh.position.z = Math.random() * 10000 - 5000;

    mesh.scale.x = mesh.scale.y = mesh.scale.z = Math.random() * 3 + 1;

    scene.add( mesh );

    spheres.push( mesh );

  }

  // Skybox

  var shader = THREE.ShaderLib[ "cube" ];
  shader.uniforms[ "tCube" ].value = textureCube;

  var material = new THREE.ShaderMaterial( {

    fragmentShader: shader.fragmentShader,
    vertexShader: shader.vertexShader,
    uniforms: shader.uniforms,
    depthWrite: false,
    side: THREE.BackSide

  } ),

  mesh = new THREE.Mesh( new THREE.BoxGeometry( 100, 100, 100 ), material );
  sceneCube.add( mesh );

  //

  renderer = new THREE.WebGLRenderer();
  renderer.setPixelRatio( window.devicePixelRatio );
  renderer.setSize( 640, 480 );
  renderer.autoClear = false;
  renderer.domElement.setAttribute('id', 'canvas');
  container.append( renderer.domElement );

  //

  window.addEventListener( 'resize', onWindowResize, false );

}

function onWindowResize() {

  windowHalfX = 640 / 2;
  windowHalfY = 480 / 2;

  camera.aspect = 640/480;
  camera.updateProjectionMatrix();

  cameraCube.aspect = 640/480;
  cameraCube.updateProjectionMatrix();


  renderer.setSize( 640, 480 );

}

function onDocumentMouseMove( event ) {

  mouseX = ( event.clientX - 640 ) * 10;
  mouseY = ( event.clientY - 480 ) * 10;

}

function animate() {

  requestAnimationFrame( animate );

  render();

}

function render() {

  var timer = 0.0001 * Date.now();

  for ( var i = 0, il = spheres.length; i < il; i ++ ) {

    var sphere = spheres[ i ];

    sphere.position.x = rx * Math.cos( timer + i );
    sphere.position.y = ry * Math.sin( timer + i * 1.1 );

  }

  camera.position.x += ( mouseX - camera.position.x ) * 0.05;
  camera.position.y += ( - mouseY - camera.position.y ) * 0.05;

  camera.lookAt( scene.position );
  cameraCube.rotation.copy( camera.rotation );

  renderer.render( sceneCube, cameraCube );
  renderer.render( scene, camera );

}


$(document).on('readyForCanvas', function(event) {
  console.log("readyForCanvas");
  init();
  animate();
  $("#canvas").on( 'mousemove', onDocumentMouseMove );
});

$(document).on('rotationValueChanged', function(event, x, y) {
  console.log('rotationValueChanged: ' + x + ', ' + y);
  rx = x;
  ry = y;
});


'use strict';

var main = angular.module('svalbardMain', []);

main.controller('MainController', ['$scope', function($scope) {
  $(document).trigger('readyForCanvas');

  $scope.updateRotation = function() {
    console.log("onClickRotationChanged");
    $(document).trigger('rotationValueChanged', [parseInt($scope.rotation.x), parseInt($scope.rotation.y)]);
  };
}]);


//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsInRocmVlanMvZXhhbXBsZS5qcyIsImNvbXBvbmVudHMvTWFpbi9tYWluQ29udHJvbGxlci5qcyIsImNvbXBvbmVudHMvVGhyZWVWaWV3ZXJDb21wb25lbnQvdmlld2VyLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7O0FBSUEsSUFBQSxjQUFBLFFBQUEsT0FBQSxlQUFBO0VBQ0E7RUFDQTs7O0FBR0EsWUFBQSxPQUFBLENBQUE7RUFDQSxTQUFBLGdCQUFBO0lBQ0E7TUFDQSxLQUFBLEtBQUE7UUFDQSxhQUFBO1FBQ0EsWUFBQTs7TUFFQSxVQUFBO1FBQ0EsWUFBQTs7Ozs7QUNoQkEsSUFBQTs7QUFFQSxJQUFBLFFBQUEsT0FBQTtBQUNBLElBQUEsWUFBQTs7QUFFQSxJQUFBLE1BQUEsV0FBQTtBQUNBLElBQUEsVUFBQTs7QUFFQSxJQUFBLGtCQUFBOztBQUVBLElBQUEsU0FBQTtBQUNBLElBQUEsU0FBQTs7QUFFQSxJQUFBLEtBQUE7QUFDQSxJQUFBLEtBQUE7O0FBRUEsSUFBQSxjQUFBLE1BQUE7QUFDQSxJQUFBLGNBQUEsTUFBQTs7O0FBR0EsU0FBQSxPQUFBOztFQUVBLFlBQUEsRUFBQTs7RUFFQSxTQUFBLElBQUEsTUFBQSxtQkFBQSxJQUFBLElBQUEsS0FBQSxHQUFBO0VBQ0EsT0FBQSxTQUFBLElBQUE7O0VBRUEsYUFBQSxJQUFBLE1BQUEsbUJBQUEsSUFBQSxJQUFBLEtBQUEsR0FBQTs7RUFFQSxRQUFBLElBQUEsTUFBQTtFQUNBLFlBQUEsSUFBQSxNQUFBOztFQUVBLElBQUEsV0FBQSxJQUFBLE1BQUEsc0JBQUEsS0FBQSxJQUFBOztFQUVBLElBQUEsT0FBQTtFQUNBLElBQUEsU0FBQTtFQUNBLElBQUEsT0FBQTtJQUNBLE9BQUEsT0FBQSxRQUFBLE9BQUEsT0FBQTtJQUNBLE9BQUEsT0FBQSxRQUFBLE9BQUEsT0FBQTtJQUNBLE9BQUEsT0FBQSxRQUFBLE9BQUEsT0FBQTs7O0VBR0EsSUFBQSxjQUFBLElBQUEsTUFBQSxvQkFBQSxNQUFBO0VBQ0EsSUFBQSxXQUFBLElBQUEsTUFBQSxtQkFBQSxFQUFBLE9BQUEsVUFBQSxRQUFBOztFQUVBLE1BQUEsSUFBQSxJQUFBLEdBQUEsSUFBQSxLQUFBLE9BQUE7O0lBRUEsSUFBQSxPQUFBLElBQUEsTUFBQSxNQUFBLFVBQUE7O0lBRUEsS0FBQSxTQUFBLElBQUEsS0FBQSxXQUFBLFFBQUE7SUFDQSxLQUFBLFNBQUEsSUFBQSxLQUFBLFdBQUEsUUFBQTtJQUNBLEtBQUEsU0FBQSxJQUFBLEtBQUEsV0FBQSxRQUFBOztJQUVBLEtBQUEsTUFBQSxJQUFBLEtBQUEsTUFBQSxJQUFBLEtBQUEsTUFBQSxJQUFBLEtBQUEsV0FBQSxJQUFBOztJQUVBLE1BQUEsS0FBQTs7SUFFQSxRQUFBLE1BQUE7Ozs7OztFQU1BLElBQUEsU0FBQSxNQUFBLFdBQUE7RUFDQSxPQUFBLFVBQUEsVUFBQSxRQUFBOztFQUVBLElBQUEsV0FBQSxJQUFBLE1BQUEsZ0JBQUE7O0lBRUEsZ0JBQUEsT0FBQTtJQUNBLGNBQUEsT0FBQTtJQUNBLFVBQUEsT0FBQTtJQUNBLFlBQUE7SUFDQSxNQUFBLE1BQUE7Ozs7RUFJQSxPQUFBLElBQUEsTUFBQSxNQUFBLElBQUEsTUFBQSxhQUFBLEtBQUEsS0FBQSxPQUFBO0VBQ0EsVUFBQSxLQUFBOzs7O0VBSUEsV0FBQSxJQUFBLE1BQUE7RUFDQSxTQUFBLGVBQUEsT0FBQTtFQUNBLFNBQUEsU0FBQSxLQUFBO0VBQ0EsU0FBQSxZQUFBO0VBQ0EsU0FBQSxXQUFBLGFBQUEsTUFBQTtFQUNBLFVBQUEsUUFBQSxTQUFBOzs7O0VBSUEsT0FBQSxrQkFBQSxVQUFBLGdCQUFBOzs7O0FBSUEsU0FBQSxpQkFBQTs7RUFFQSxjQUFBLE1BQUE7RUFDQSxjQUFBLE1BQUE7O0VBRUEsT0FBQSxTQUFBLElBQUE7RUFDQSxPQUFBOztFQUVBLFdBQUEsU0FBQSxJQUFBO0VBQ0EsV0FBQTs7O0VBR0EsU0FBQSxTQUFBLEtBQUE7Ozs7QUFJQSxTQUFBLHFCQUFBLFFBQUE7O0VBRUEsU0FBQSxFQUFBLE1BQUEsVUFBQSxRQUFBO0VBQ0EsU0FBQSxFQUFBLE1BQUEsVUFBQSxRQUFBOzs7O0FBSUEsU0FBQSxVQUFBOztFQUVBLHVCQUFBOztFQUVBOzs7O0FBSUEsU0FBQSxTQUFBOztFQUVBLElBQUEsUUFBQSxTQUFBLEtBQUE7O0VBRUEsTUFBQSxJQUFBLElBQUEsR0FBQSxLQUFBLFFBQUEsUUFBQSxJQUFBLElBQUEsT0FBQTs7SUFFQSxJQUFBLFNBQUEsU0FBQTs7SUFFQSxPQUFBLFNBQUEsSUFBQSxLQUFBLEtBQUEsS0FBQSxRQUFBO0lBQ0EsT0FBQSxTQUFBLElBQUEsS0FBQSxLQUFBLEtBQUEsUUFBQSxJQUFBOzs7O0VBSUEsT0FBQSxTQUFBLEtBQUEsRUFBQSxTQUFBLE9BQUEsU0FBQSxNQUFBO0VBQ0EsT0FBQSxTQUFBLEtBQUEsRUFBQSxFQUFBLFNBQUEsT0FBQSxTQUFBLE1BQUE7O0VBRUEsT0FBQSxRQUFBLE1BQUE7RUFDQSxXQUFBLFNBQUEsTUFBQSxPQUFBOztFQUVBLFNBQUEsUUFBQSxXQUFBO0VBQ0EsU0FBQSxRQUFBLE9BQUE7Ozs7O0FBS0EsRUFBQSxVQUFBLEdBQUEsa0JBQUEsU0FBQSxPQUFBO0VBQ0EsUUFBQSxJQUFBO0VBQ0E7RUFDQTtFQUNBLEVBQUEsV0FBQSxJQUFBLGFBQUE7OztBQUdBLEVBQUEsVUFBQSxHQUFBLHdCQUFBLFNBQUEsT0FBQSxHQUFBLEdBQUE7RUFDQSxRQUFBLElBQUEsMkJBQUEsSUFBQSxPQUFBO0VBQ0EsS0FBQTtFQUNBLEtBQUE7Ozs7QUNoS0E7O0FBRUEsSUFBQSxPQUFBLFFBQUEsT0FBQSxnQkFBQTs7QUFFQSxLQUFBLFdBQUEsa0JBQUEsQ0FBQSxVQUFBLFNBQUEsUUFBQTtFQUNBLEVBQUEsVUFBQSxRQUFBOztFQUVBLE9BQUEsaUJBQUEsV0FBQTtJQUNBLFFBQUEsSUFBQTtJQUNBLEVBQUEsVUFBQSxRQUFBLHdCQUFBLENBQUEsU0FBQSxPQUFBLFNBQUEsSUFBQSxTQUFBLE9BQUEsU0FBQTs7OztBQ1ZBIiwiZmlsZSI6ImJ1bmRsZS5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbi8qIEFwcCBNb2R1bGUgKi9cblxudmFyIHBob25lY2F0QXBwID0gYW5ndWxhci5tb2R1bGUoJ3N2YWxiYXJkQXBwJywgW1xuICAnbmdSb3V0ZScsXG4gICdzdmFsYmFyZE1haW4nLFxuXSk7XG5cbnBob25lY2F0QXBwLmNvbmZpZyhbJyRyb3V0ZVByb3ZpZGVyJyxcbiAgZnVuY3Rpb24oJHJvdXRlUHJvdmlkZXIpIHtcbiAgICAkcm91dGVQcm92aWRlci5cbiAgICAgIHdoZW4oJy8nLCB7XG4gICAgICAgIHRlbXBsYXRlVXJsOiAnY29tcG9uZW50cy9NYWluL21haW4uaHRtbCcsXG4gICAgICAgIGNvbnRyb2xsZXI6ICdNYWluQ29udHJvbGxlcidcbiAgICAgIH0pLlxuICAgICAgb3RoZXJ3aXNlKHtcbiAgICAgICAgcmVkaXJlY3RUbzogJy8nXG4gICAgICB9KTtcbiAgfV0pO1xuIiwiXG52YXIgY29udGFpbmVyO1xuXG52YXIgY2FtZXJhLCBzY2VuZSwgcmVuZGVyZXI7XG52YXIgY2FtZXJhQ3ViZSwgc2NlbmVDdWJlO1xuXG52YXIgbWVzaCwgbGlnaHRNZXNoLCBnZW9tZXRyeTtcbnZhciBzcGhlcmVzID0gW107XG5cbnZhciBkaXJlY3Rpb25hbExpZ2h0LCBwb2ludExpZ2h0O1xuXG52YXIgbW91c2VYID0gMDtcbnZhciBtb3VzZVkgPSAwO1xuXG52YXIgcnggPSA1MDAwO1xudmFyIHJ5ID0gNTAwMDtcblxudmFyIHdpbmRvd0hhbGZYID0gNjQwIC8gMjtcbnZhciB3aW5kb3dIYWxmWSA9IDQ4MCAvIDI7XG5cblxuZnVuY3Rpb24gaW5pdCgpIHtcblxuICBjb250YWluZXIgPSAkKCcjbWFpbicpO1xuXG4gIGNhbWVyYSA9IG5ldyBUSFJFRS5QZXJzcGVjdGl2ZUNhbWVyYSggNjAsIDY0MC80ODAsIDEsIDEwMDAwMCApO1xuICBjYW1lcmEucG9zaXRpb24ueiA9IDMyMDA7XG5cbiAgY2FtZXJhQ3ViZSA9IG5ldyBUSFJFRS5QZXJzcGVjdGl2ZUNhbWVyYSggNjAsIDY0MC80ODAsIDEsIDEwMDAwMCApO1xuXG4gIHNjZW5lID0gbmV3IFRIUkVFLlNjZW5lKCk7XG4gIHNjZW5lQ3ViZSA9IG5ldyBUSFJFRS5TY2VuZSgpO1xuXG4gIHZhciBnZW9tZXRyeSA9IG5ldyBUSFJFRS5TcGhlcmVCdWZmZXJHZW9tZXRyeSggMTAwLCAzMiwgMTYgKTtcblxuICB2YXIgcGF0aCA9IFwiYXNzZXRzL2ltYWdlcy9waXNhL1wiO1xuICB2YXIgZm9ybWF0ID0gJy5wbmcnO1xuICB2YXIgdXJscyA9IFtcbiAgICBwYXRoICsgJ3B4JyArIGZvcm1hdCwgcGF0aCArICdueCcgKyBmb3JtYXQsXG4gICAgcGF0aCArICdweScgKyBmb3JtYXQsIHBhdGggKyAnbnknICsgZm9ybWF0LFxuICAgIHBhdGggKyAncHonICsgZm9ybWF0LCBwYXRoICsgJ256JyArIGZvcm1hdFxuICBdO1xuXG4gIHZhciB0ZXh0dXJlQ3ViZSA9IG5ldyBUSFJFRS5DdWJlVGV4dHVyZUxvYWRlcigpLmxvYWQoIHVybHMgKTtcbiAgdmFyIG1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hCYXNpY01hdGVyaWFsKCB7IGNvbG9yOiAweGZmZmZmZiwgZW52TWFwOiB0ZXh0dXJlQ3ViZSB9ICk7XG5cbiAgZm9yICggdmFyIGkgPSAwOyBpIDwgNTAwOyBpICsrICkge1xuXG4gICAgdmFyIG1lc2ggPSBuZXcgVEhSRUUuTWVzaCggZ2VvbWV0cnksIG1hdGVyaWFsICk7XG5cbiAgICBtZXNoLnBvc2l0aW9uLnggPSBNYXRoLnJhbmRvbSgpICogMTAwMDAgLSA1MDAwO1xuICAgIG1lc2gucG9zaXRpb24ueSA9IE1hdGgucmFuZG9tKCkgKiAxMDAwMCAtIDUwMDA7XG4gICAgbWVzaC5wb3NpdGlvbi56ID0gTWF0aC5yYW5kb20oKSAqIDEwMDAwIC0gNTAwMDtcblxuICAgIG1lc2guc2NhbGUueCA9IG1lc2guc2NhbGUueSA9IG1lc2guc2NhbGUueiA9IE1hdGgucmFuZG9tKCkgKiAzICsgMTtcblxuICAgIHNjZW5lLmFkZCggbWVzaCApO1xuXG4gICAgc3BoZXJlcy5wdXNoKCBtZXNoICk7XG5cbiAgfVxuXG4gIC8vIFNreWJveFxuXG4gIHZhciBzaGFkZXIgPSBUSFJFRS5TaGFkZXJMaWJbIFwiY3ViZVwiIF07XG4gIHNoYWRlci51bmlmb3Jtc1sgXCJ0Q3ViZVwiIF0udmFsdWUgPSB0ZXh0dXJlQ3ViZTtcblxuICB2YXIgbWF0ZXJpYWwgPSBuZXcgVEhSRUUuU2hhZGVyTWF0ZXJpYWwoIHtcblxuICAgIGZyYWdtZW50U2hhZGVyOiBzaGFkZXIuZnJhZ21lbnRTaGFkZXIsXG4gICAgdmVydGV4U2hhZGVyOiBzaGFkZXIudmVydGV4U2hhZGVyLFxuICAgIHVuaWZvcm1zOiBzaGFkZXIudW5pZm9ybXMsXG4gICAgZGVwdGhXcml0ZTogZmFsc2UsXG4gICAgc2lkZTogVEhSRUUuQmFja1NpZGVcblxuICB9ICksXG5cbiAgbWVzaCA9IG5ldyBUSFJFRS5NZXNoKCBuZXcgVEhSRUUuQm94R2VvbWV0cnkoIDEwMCwgMTAwLCAxMDAgKSwgbWF0ZXJpYWwgKTtcbiAgc2NlbmVDdWJlLmFkZCggbWVzaCApO1xuXG4gIC8vXG5cbiAgcmVuZGVyZXIgPSBuZXcgVEhSRUUuV2ViR0xSZW5kZXJlcigpO1xuICByZW5kZXJlci5zZXRQaXhlbFJhdGlvKCB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyApO1xuICByZW5kZXJlci5zZXRTaXplKCA2NDAsIDQ4MCApO1xuICByZW5kZXJlci5hdXRvQ2xlYXIgPSBmYWxzZTtcbiAgcmVuZGVyZXIuZG9tRWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2lkJywgJ2NhbnZhcycpO1xuICBjb250YWluZXIuYXBwZW5kKCByZW5kZXJlci5kb21FbGVtZW50ICk7XG5cbiAgLy9cblxuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lciggJ3Jlc2l6ZScsIG9uV2luZG93UmVzaXplLCBmYWxzZSApO1xuXG59XG5cbmZ1bmN0aW9uIG9uV2luZG93UmVzaXplKCkge1xuXG4gIHdpbmRvd0hhbGZYID0gNjQwIC8gMjtcbiAgd2luZG93SGFsZlkgPSA0ODAgLyAyO1xuXG4gIGNhbWVyYS5hc3BlY3QgPSA2NDAvNDgwO1xuICBjYW1lcmEudXBkYXRlUHJvamVjdGlvbk1hdHJpeCgpO1xuXG4gIGNhbWVyYUN1YmUuYXNwZWN0ID0gNjQwLzQ4MDtcbiAgY2FtZXJhQ3ViZS51cGRhdGVQcm9qZWN0aW9uTWF0cml4KCk7XG5cblxuICByZW5kZXJlci5zZXRTaXplKCA2NDAsIDQ4MCApO1xuXG59XG5cbmZ1bmN0aW9uIG9uRG9jdW1lbnRNb3VzZU1vdmUoIGV2ZW50ICkge1xuXG4gIG1vdXNlWCA9ICggZXZlbnQuY2xpZW50WCAtIDY0MCApICogMTA7XG4gIG1vdXNlWSA9ICggZXZlbnQuY2xpZW50WSAtIDQ4MCApICogMTA7XG5cbn1cblxuZnVuY3Rpb24gYW5pbWF0ZSgpIHtcblxuICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoIGFuaW1hdGUgKTtcblxuICByZW5kZXIoKTtcblxufVxuXG5mdW5jdGlvbiByZW5kZXIoKSB7XG5cbiAgdmFyIHRpbWVyID0gMC4wMDAxICogRGF0ZS5ub3coKTtcblxuICBmb3IgKCB2YXIgaSA9IDAsIGlsID0gc3BoZXJlcy5sZW5ndGg7IGkgPCBpbDsgaSArKyApIHtcblxuICAgIHZhciBzcGhlcmUgPSBzcGhlcmVzWyBpIF07XG5cbiAgICBzcGhlcmUucG9zaXRpb24ueCA9IHJ4ICogTWF0aC5jb3MoIHRpbWVyICsgaSApO1xuICAgIHNwaGVyZS5wb3NpdGlvbi55ID0gcnkgKiBNYXRoLnNpbiggdGltZXIgKyBpICogMS4xICk7XG5cbiAgfVxuXG4gIGNhbWVyYS5wb3NpdGlvbi54ICs9ICggbW91c2VYIC0gY2FtZXJhLnBvc2l0aW9uLnggKSAqIDAuMDU7XG4gIGNhbWVyYS5wb3NpdGlvbi55ICs9ICggLSBtb3VzZVkgLSBjYW1lcmEucG9zaXRpb24ueSApICogMC4wNTtcblxuICBjYW1lcmEubG9va0F0KCBzY2VuZS5wb3NpdGlvbiApO1xuICBjYW1lcmFDdWJlLnJvdGF0aW9uLmNvcHkoIGNhbWVyYS5yb3RhdGlvbiApO1xuXG4gIHJlbmRlcmVyLnJlbmRlciggc2NlbmVDdWJlLCBjYW1lcmFDdWJlICk7XG4gIHJlbmRlcmVyLnJlbmRlciggc2NlbmUsIGNhbWVyYSApO1xuXG59XG5cblxuJChkb2N1bWVudCkub24oJ3JlYWR5Rm9yQ2FudmFzJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgY29uc29sZS5sb2coXCJyZWFkeUZvckNhbnZhc1wiKTtcbiAgaW5pdCgpO1xuICBhbmltYXRlKCk7XG4gICQoXCIjY2FudmFzXCIpLm9uKCAnbW91c2Vtb3ZlJywgb25Eb2N1bWVudE1vdXNlTW92ZSApO1xufSk7XG5cbiQoZG9jdW1lbnQpLm9uKCdyb3RhdGlvblZhbHVlQ2hhbmdlZCcsIGZ1bmN0aW9uKGV2ZW50LCB4LCB5KSB7XG4gIGNvbnNvbGUubG9nKCdyb3RhdGlvblZhbHVlQ2hhbmdlZDogJyArIHggKyAnLCAnICsgeSk7XG4gIHJ4ID0geDtcbiAgcnkgPSB5O1xufSk7XG4iLCJcbid1c2Ugc3RyaWN0JztcblxudmFyIG1haW4gPSBhbmd1bGFyLm1vZHVsZSgnc3ZhbGJhcmRNYWluJywgW10pO1xuXG5tYWluLmNvbnRyb2xsZXIoJ01haW5Db250cm9sbGVyJywgWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHtcbiAgJChkb2N1bWVudCkudHJpZ2dlcigncmVhZHlGb3JDYW52YXMnKTtcblxuICAkc2NvcGUudXBkYXRlUm90YXRpb24gPSBmdW5jdGlvbigpIHtcbiAgICBjb25zb2xlLmxvZyhcIm9uQ2xpY2tSb3RhdGlvbkNoYW5nZWRcIik7XG4gICAgJChkb2N1bWVudCkudHJpZ2dlcigncm90YXRpb25WYWx1ZUNoYW5nZWQnLCBbcGFyc2VJbnQoJHNjb3BlLnJvdGF0aW9uLngpLCBwYXJzZUludCgkc2NvcGUucm90YXRpb24ueSldKTtcbiAgfTtcbn1dKTtcbiIsIiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
