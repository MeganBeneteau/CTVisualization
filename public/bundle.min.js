'use strict';

/* App Module */

var ctApp = angular.module('ctApp', [
  'ngRoute',
  'ctMain',
]);

ctApp.config(['$routeProvider',
  function($routeProvider) {
    $routeProvider.
      when('/', {
        templateUrl: 'components/Main/main.html',
        controller: 'MainController'
      }).
      otherwise({
        redirectTo: '/'
      });
  }]);


var container;

var camera, scene, renderer;
var cameraCube, sceneCube;

var mesh, lightMesh, geometry;
var spheres = [];

var directionalLight, pointLight;

var mouseX = 0;
var mouseY = 0;

var rx = 5000;
var ry = 5000;

var windowHalfX = 640 / 2;
var windowHalfY = 480 / 2;


function init() {

  container = $('#main');

  camera = new THREE.PerspectiveCamera( 60, 640/480, 1, 100000 );
  camera.position.z = 3200;

  cameraCube = new THREE.PerspectiveCamera( 60, 640/480, 1, 100000 );

  scene = new THREE.Scene();
  sceneCube = new THREE.Scene();

  var geometry = new THREE.SphereBufferGeometry( 100, 32, 16 );

  var path = "assets/images/pisa/";
  var format = '.png';
  var urls = [
    path + 'px' + format, path + 'nx' + format,
    path + 'py' + format, path + 'ny' + format,
    path + 'pz' + format, path + 'nz' + format
  ];

  var textureCube = new THREE.CubeTextureLoader().load( urls );
  var material = new THREE.MeshBasicMaterial( { color: 0xffffff, envMap: textureCube } );

  for ( var i = 0; i < 500; i ++ ) {

    var mesh = new THREE.Mesh( geometry, material );

    mesh.position.x = Math.random() * 10000 - 5000;
    mesh.position.y = Math.random() * 10000 - 5000;
    mesh.position.z = Math.random() * 10000 - 5000;

    mesh.scale.x = mesh.scale.y = mesh.scale.z = Math.random() * 3 + 1;

    scene.add( mesh );

    spheres.push( mesh );

  }

  // Skybox

  var shader = THREE.ShaderLib[ "cube" ];
  shader.uniforms[ "tCube" ].value = textureCube;

  var material = new THREE.ShaderMaterial( {

    fragmentShader: shader.fragmentShader,
    vertexShader: shader.vertexShader,
    uniforms: shader.uniforms,
    depthWrite: false,
    side: THREE.BackSide

  } ),

  mesh = new THREE.Mesh( new THREE.BoxGeometry( 100, 100, 100 ), material );
  sceneCube.add( mesh );

  //

  renderer = new THREE.WebGLRenderer();
  renderer.setPixelRatio( window.devicePixelRatio );
  renderer.setSize( 640, 480 );
  renderer.autoClear = false;
  renderer.domElement.setAttribute('id', 'canvas');
  container.append( renderer.domElement );

  //

  window.addEventListener( 'resize', onWindowResize, false );

}

function onWindowResize() {

  windowHalfX = 640 / 2;
  windowHalfY = 480 / 2;

  camera.aspect = 640/480;
  camera.updateProjectionMatrix();

  cameraCube.aspect = 640/480;
  cameraCube.updateProjectionMatrix();


  renderer.setSize( 640, 480 );

}

function onDocumentMouseMove( event ) {

  mouseX = ( event.clientX - 640 ) * 10;
  mouseY = ( event.clientY - 480 ) * 10;

}

function animate() {

  requestAnimationFrame( animate );

  render();

}

function render() {

  var timer = 0.0001 * Date.now();

  for ( var i = 0, il = spheres.length; i < il; i ++ ) {

    var sphere = spheres[ i ];

    sphere.position.x = rx * Math.cos( timer + i );
    sphere.position.y = ry * Math.sin( timer + i * 1.1 );

  }

  camera.position.x += ( mouseX - camera.position.x ) * 0.05;
  camera.position.y += ( - mouseY - camera.position.y ) * 0.05;

  camera.lookAt( scene.position );
  cameraCube.rotation.copy( camera.rotation );

  renderer.render( sceneCube, cameraCube );
  renderer.render( scene, camera );

}


$(document).on('readyForCanvas', function(event) {
  console.log("readyForCanvas");
  init();
  animate();
  $("#canvas").on( 'mousemove', onDocumentMouseMove );
});

$(document).on('rotationValueChanged', function(event, x, y) {
  console.log('rotationValueChanged: ' + x + ', ' + y);
  rx = x;
  ry = y;
});


'use strict';

var main = angular.module('ctMain', []);

main.controller('MainController', ['$scope', function($scope) {
  $(document).trigger('readyForCanvas');

  $scope.updateRotation = function() {
    console.log("onClickRotationChanged");
    $(document).trigger('rotationValueChanged', [parseInt($scope.rotation.x), parseInt($scope.rotation.y)]);
  };
}]);


//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsInRocmVlanMvZXhhbXBsZS5qcyIsImNvbXBvbmVudHMvTWFpbi9tYWluQ29udHJvbGxlci5qcyIsImNvbXBvbmVudHMvVGhyZWVWaWV3ZXJDb21wb25lbnQvdmlld2VyLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7O0FBSUEsSUFBQSxRQUFBLFFBQUEsT0FBQSxTQUFBO0VBQ0E7RUFDQTs7O0FBR0EsTUFBQSxPQUFBLENBQUE7RUFDQSxTQUFBLGdCQUFBO0lBQ0E7TUFDQSxLQUFBLEtBQUE7UUFDQSxhQUFBO1FBQ0EsWUFBQTs7TUFFQSxVQUFBO1FBQ0EsWUFBQTs7Ozs7QUNoQkEsSUFBQTs7QUFFQSxJQUFBLFFBQUEsT0FBQTtBQUNBLElBQUEsWUFBQTs7QUFFQSxJQUFBLE1BQUEsV0FBQTtBQUNBLElBQUEsVUFBQTs7QUFFQSxJQUFBLGtCQUFBOztBQUVBLElBQUEsU0FBQTtBQUNBLElBQUEsU0FBQTs7QUFFQSxJQUFBLEtBQUE7QUFDQSxJQUFBLEtBQUE7O0FBRUEsSUFBQSxjQUFBLE1BQUE7QUFDQSxJQUFBLGNBQUEsTUFBQTs7O0FBR0EsU0FBQSxPQUFBOztFQUVBLFlBQUEsRUFBQTs7RUFFQSxTQUFBLElBQUEsTUFBQSxtQkFBQSxJQUFBLElBQUEsS0FBQSxHQUFBO0VBQ0EsT0FBQSxTQUFBLElBQUE7O0VBRUEsYUFBQSxJQUFBLE1BQUEsbUJBQUEsSUFBQSxJQUFBLEtBQUEsR0FBQTs7RUFFQSxRQUFBLElBQUEsTUFBQTtFQUNBLFlBQUEsSUFBQSxNQUFBOztFQUVBLElBQUEsV0FBQSxJQUFBLE1BQUEsc0JBQUEsS0FBQSxJQUFBOztFQUVBLElBQUEsT0FBQTtFQUNBLElBQUEsU0FBQTtFQUNBLElBQUEsT0FBQTtJQUNBLE9BQUEsT0FBQSxRQUFBLE9BQUEsT0FBQTtJQUNBLE9BQUEsT0FBQSxRQUFBLE9BQUEsT0FBQTtJQUNBLE9BQUEsT0FBQSxRQUFBLE9BQUEsT0FBQTs7O0VBR0EsSUFBQSxjQUFBLElBQUEsTUFBQSxvQkFBQSxNQUFBO0VBQ0EsSUFBQSxXQUFBLElBQUEsTUFBQSxtQkFBQSxFQUFBLE9BQUEsVUFBQSxRQUFBOztFQUVBLE1BQUEsSUFBQSxJQUFBLEdBQUEsSUFBQSxLQUFBLE9BQUE7O0lBRUEsSUFBQSxPQUFBLElBQUEsTUFBQSxNQUFBLFVBQUE7O0lBRUEsS0FBQSxTQUFBLElBQUEsS0FBQSxXQUFBLFFBQUE7SUFDQSxLQUFBLFNBQUEsSUFBQSxLQUFBLFdBQUEsUUFBQTtJQUNBLEtBQUEsU0FBQSxJQUFBLEtBQUEsV0FBQSxRQUFBOztJQUVBLEtBQUEsTUFBQSxJQUFBLEtBQUEsTUFBQSxJQUFBLEtBQUEsTUFBQSxJQUFBLEtBQUEsV0FBQSxJQUFBOztJQUVBLE1BQUEsS0FBQTs7SUFFQSxRQUFBLE1BQUE7Ozs7OztFQU1BLElBQUEsU0FBQSxNQUFBLFdBQUE7RUFDQSxPQUFBLFVBQUEsVUFBQSxRQUFBOztFQUVBLElBQUEsV0FBQSxJQUFBLE1BQUEsZ0JBQUE7O0lBRUEsZ0JBQUEsT0FBQTtJQUNBLGNBQUEsT0FBQTtJQUNBLFVBQUEsT0FBQTtJQUNBLFlBQUE7SUFDQSxNQUFBLE1BQUE7Ozs7RUFJQSxPQUFBLElBQUEsTUFBQSxNQUFBLElBQUEsTUFBQSxhQUFBLEtBQUEsS0FBQSxPQUFBO0VBQ0EsVUFBQSxLQUFBOzs7O0VBSUEsV0FBQSxJQUFBLE1BQUE7RUFDQSxTQUFBLGVBQUEsT0FBQTtFQUNBLFNBQUEsU0FBQSxLQUFBO0VBQ0EsU0FBQSxZQUFBO0VBQ0EsU0FBQSxXQUFBLGFBQUEsTUFBQTtFQUNBLFVBQUEsUUFBQSxTQUFBOzs7O0VBSUEsT0FBQSxrQkFBQSxVQUFBLGdCQUFBOzs7O0FBSUEsU0FBQSxpQkFBQTs7RUFFQSxjQUFBLE1BQUE7RUFDQSxjQUFBLE1BQUE7O0VBRUEsT0FBQSxTQUFBLElBQUE7RUFDQSxPQUFBOztFQUVBLFdBQUEsU0FBQSxJQUFBO0VBQ0EsV0FBQTs7O0VBR0EsU0FBQSxTQUFBLEtBQUE7Ozs7QUFJQSxTQUFBLHFCQUFBLFFBQUE7O0VBRUEsU0FBQSxFQUFBLE1BQUEsVUFBQSxRQUFBO0VBQ0EsU0FBQSxFQUFBLE1BQUEsVUFBQSxRQUFBOzs7O0FBSUEsU0FBQSxVQUFBOztFQUVBLHVCQUFBOztFQUVBOzs7O0FBSUEsU0FBQSxTQUFBOztFQUVBLElBQUEsUUFBQSxTQUFBLEtBQUE7O0VBRUEsTUFBQSxJQUFBLElBQUEsR0FBQSxLQUFBLFFBQUEsUUFBQSxJQUFBLElBQUEsT0FBQTs7SUFFQSxJQUFBLFNBQUEsU0FBQTs7SUFFQSxPQUFBLFNBQUEsSUFBQSxLQUFBLEtBQUEsS0FBQSxRQUFBO0lBQ0EsT0FBQSxTQUFBLElBQUEsS0FBQSxLQUFBLEtBQUEsUUFBQSxJQUFBOzs7O0VBSUEsT0FBQSxTQUFBLEtBQUEsRUFBQSxTQUFBLE9BQUEsU0FBQSxNQUFBO0VBQ0EsT0FBQSxTQUFBLEtBQUEsRUFBQSxFQUFBLFNBQUEsT0FBQSxTQUFBLE1BQUE7O0VBRUEsT0FBQSxRQUFBLE1BQUE7RUFDQSxXQUFBLFNBQUEsTUFBQSxPQUFBOztFQUVBLFNBQUEsUUFBQSxXQUFBO0VBQ0EsU0FBQSxRQUFBLE9BQUE7Ozs7O0FBS0EsRUFBQSxVQUFBLEdBQUEsa0JBQUEsU0FBQSxPQUFBO0VBQ0EsUUFBQSxJQUFBO0VBQ0E7RUFDQTtFQUNBLEVBQUEsV0FBQSxJQUFBLGFBQUE7OztBQUdBLEVBQUEsVUFBQSxHQUFBLHdCQUFBLFNBQUEsT0FBQSxHQUFBLEdBQUE7RUFDQSxRQUFBLElBQUEsMkJBQUEsSUFBQSxPQUFBO0VBQ0EsS0FBQTtFQUNBLEtBQUE7Ozs7QUNoS0E7O0FBRUEsSUFBQSxPQUFBLFFBQUEsT0FBQSxVQUFBOztBQUVBLEtBQUEsV0FBQSxrQkFBQSxDQUFBLFVBQUEsU0FBQSxRQUFBO0VBQ0EsRUFBQSxVQUFBLFFBQUE7O0VBRUEsT0FBQSxpQkFBQSxXQUFBO0lBQ0EsUUFBQSxJQUFBO0lBQ0EsRUFBQSxVQUFBLFFBQUEsd0JBQUEsQ0FBQSxTQUFBLE9BQUEsU0FBQSxJQUFBLFNBQUEsT0FBQSxTQUFBOzs7O0FDVkEiLCJmaWxlIjoiYnVuZGxlLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuLyogQXBwIE1vZHVsZSAqL1xuXG52YXIgY3RBcHAgPSBhbmd1bGFyLm1vZHVsZSgnY3RBcHAnLCBbXG4gICduZ1JvdXRlJyxcbiAgJ2N0TWFpbicsXG5dKTtcblxuY3RBcHAuY29uZmlnKFsnJHJvdXRlUHJvdmlkZXInLFxuICBmdW5jdGlvbigkcm91dGVQcm92aWRlcikge1xuICAgICRyb3V0ZVByb3ZpZGVyLlxuICAgICAgd2hlbignLycsIHtcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdjb21wb25lbnRzL01haW4vbWFpbi5odG1sJyxcbiAgICAgICAgY29udHJvbGxlcjogJ01haW5Db250cm9sbGVyJ1xuICAgICAgfSkuXG4gICAgICBvdGhlcndpc2Uoe1xuICAgICAgICByZWRpcmVjdFRvOiAnLydcbiAgICAgIH0pO1xuICB9XSk7XG4iLCJcbnZhciBjb250YWluZXI7XG5cbnZhciBjYW1lcmEsIHNjZW5lLCByZW5kZXJlcjtcbnZhciBjYW1lcmFDdWJlLCBzY2VuZUN1YmU7XG5cbnZhciBtZXNoLCBsaWdodE1lc2gsIGdlb21ldHJ5O1xudmFyIHNwaGVyZXMgPSBbXTtcblxudmFyIGRpcmVjdGlvbmFsTGlnaHQsIHBvaW50TGlnaHQ7XG5cbnZhciBtb3VzZVggPSAwO1xudmFyIG1vdXNlWSA9IDA7XG5cbnZhciByeCA9IDUwMDA7XG52YXIgcnkgPSA1MDAwO1xuXG52YXIgd2luZG93SGFsZlggPSA2NDAgLyAyO1xudmFyIHdpbmRvd0hhbGZZID0gNDgwIC8gMjtcblxuXG5mdW5jdGlvbiBpbml0KCkge1xuXG4gIGNvbnRhaW5lciA9ICQoJyNtYWluJyk7XG5cbiAgY2FtZXJhID0gbmV3IFRIUkVFLlBlcnNwZWN0aXZlQ2FtZXJhKCA2MCwgNjQwLzQ4MCwgMSwgMTAwMDAwICk7XG4gIGNhbWVyYS5wb3NpdGlvbi56ID0gMzIwMDtcblxuICBjYW1lcmFDdWJlID0gbmV3IFRIUkVFLlBlcnNwZWN0aXZlQ2FtZXJhKCA2MCwgNjQwLzQ4MCwgMSwgMTAwMDAwICk7XG5cbiAgc2NlbmUgPSBuZXcgVEhSRUUuU2NlbmUoKTtcbiAgc2NlbmVDdWJlID0gbmV3IFRIUkVFLlNjZW5lKCk7XG5cbiAgdmFyIGdlb21ldHJ5ID0gbmV3IFRIUkVFLlNwaGVyZUJ1ZmZlckdlb21ldHJ5KCAxMDAsIDMyLCAxNiApO1xuXG4gIHZhciBwYXRoID0gXCJhc3NldHMvaW1hZ2VzL3Bpc2EvXCI7XG4gIHZhciBmb3JtYXQgPSAnLnBuZyc7XG4gIHZhciB1cmxzID0gW1xuICAgIHBhdGggKyAncHgnICsgZm9ybWF0LCBwYXRoICsgJ254JyArIGZvcm1hdCxcbiAgICBwYXRoICsgJ3B5JyArIGZvcm1hdCwgcGF0aCArICdueScgKyBmb3JtYXQsXG4gICAgcGF0aCArICdweicgKyBmb3JtYXQsIHBhdGggKyAnbnonICsgZm9ybWF0XG4gIF07XG5cbiAgdmFyIHRleHR1cmVDdWJlID0gbmV3IFRIUkVFLkN1YmVUZXh0dXJlTG9hZGVyKCkubG9hZCggdXJscyApO1xuICB2YXIgbWF0ZXJpYWwgPSBuZXcgVEhSRUUuTWVzaEJhc2ljTWF0ZXJpYWwoIHsgY29sb3I6IDB4ZmZmZmZmLCBlbnZNYXA6IHRleHR1cmVDdWJlIH0gKTtcblxuICBmb3IgKCB2YXIgaSA9IDA7IGkgPCA1MDA7IGkgKysgKSB7XG5cbiAgICB2YXIgbWVzaCA9IG5ldyBUSFJFRS5NZXNoKCBnZW9tZXRyeSwgbWF0ZXJpYWwgKTtcblxuICAgIG1lc2gucG9zaXRpb24ueCA9IE1hdGgucmFuZG9tKCkgKiAxMDAwMCAtIDUwMDA7XG4gICAgbWVzaC5wb3NpdGlvbi55ID0gTWF0aC5yYW5kb20oKSAqIDEwMDAwIC0gNTAwMDtcbiAgICBtZXNoLnBvc2l0aW9uLnogPSBNYXRoLnJhbmRvbSgpICogMTAwMDAgLSA1MDAwO1xuXG4gICAgbWVzaC5zY2FsZS54ID0gbWVzaC5zY2FsZS55ID0gbWVzaC5zY2FsZS56ID0gTWF0aC5yYW5kb20oKSAqIDMgKyAxO1xuXG4gICAgc2NlbmUuYWRkKCBtZXNoICk7XG5cbiAgICBzcGhlcmVzLnB1c2goIG1lc2ggKTtcblxuICB9XG5cbiAgLy8gU2t5Ym94XG5cbiAgdmFyIHNoYWRlciA9IFRIUkVFLlNoYWRlckxpYlsgXCJjdWJlXCIgXTtcbiAgc2hhZGVyLnVuaWZvcm1zWyBcInRDdWJlXCIgXS52YWx1ZSA9IHRleHR1cmVDdWJlO1xuXG4gIHZhciBtYXRlcmlhbCA9IG5ldyBUSFJFRS5TaGFkZXJNYXRlcmlhbCgge1xuXG4gICAgZnJhZ21lbnRTaGFkZXI6IHNoYWRlci5mcmFnbWVudFNoYWRlcixcbiAgICB2ZXJ0ZXhTaGFkZXI6IHNoYWRlci52ZXJ0ZXhTaGFkZXIsXG4gICAgdW5pZm9ybXM6IHNoYWRlci51bmlmb3JtcyxcbiAgICBkZXB0aFdyaXRlOiBmYWxzZSxcbiAgICBzaWRlOiBUSFJFRS5CYWNrU2lkZVxuXG4gIH0gKSxcblxuICBtZXNoID0gbmV3IFRIUkVFLk1lc2goIG5ldyBUSFJFRS5Cb3hHZW9tZXRyeSggMTAwLCAxMDAsIDEwMCApLCBtYXRlcmlhbCApO1xuICBzY2VuZUN1YmUuYWRkKCBtZXNoICk7XG5cbiAgLy9cblxuICByZW5kZXJlciA9IG5ldyBUSFJFRS5XZWJHTFJlbmRlcmVyKCk7XG4gIHJlbmRlcmVyLnNldFBpeGVsUmF0aW8oIHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvICk7XG4gIHJlbmRlcmVyLnNldFNpemUoIDY0MCwgNDgwICk7XG4gIHJlbmRlcmVyLmF1dG9DbGVhciA9IGZhbHNlO1xuICByZW5kZXJlci5kb21FbGVtZW50LnNldEF0dHJpYnV0ZSgnaWQnLCAnY2FudmFzJyk7XG4gIGNvbnRhaW5lci5hcHBlbmQoIHJlbmRlcmVyLmRvbUVsZW1lbnQgKTtcblxuICAvL1xuXG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCAncmVzaXplJywgb25XaW5kb3dSZXNpemUsIGZhbHNlICk7XG5cbn1cblxuZnVuY3Rpb24gb25XaW5kb3dSZXNpemUoKSB7XG5cbiAgd2luZG93SGFsZlggPSA2NDAgLyAyO1xuICB3aW5kb3dIYWxmWSA9IDQ4MCAvIDI7XG5cbiAgY2FtZXJhLmFzcGVjdCA9IDY0MC80ODA7XG4gIGNhbWVyYS51cGRhdGVQcm9qZWN0aW9uTWF0cml4KCk7XG5cbiAgY2FtZXJhQ3ViZS5hc3BlY3QgPSA2NDAvNDgwO1xuICBjYW1lcmFDdWJlLnVwZGF0ZVByb2plY3Rpb25NYXRyaXgoKTtcblxuXG4gIHJlbmRlcmVyLnNldFNpemUoIDY0MCwgNDgwICk7XG5cbn1cblxuZnVuY3Rpb24gb25Eb2N1bWVudE1vdXNlTW92ZSggZXZlbnQgKSB7XG5cbiAgbW91c2VYID0gKCBldmVudC5jbGllbnRYIC0gNjQwICkgKiAxMDtcbiAgbW91c2VZID0gKCBldmVudC5jbGllbnRZIC0gNDgwICkgKiAxMDtcblxufVxuXG5mdW5jdGlvbiBhbmltYXRlKCkge1xuXG4gIHJlcXVlc3RBbmltYXRpb25GcmFtZSggYW5pbWF0ZSApO1xuXG4gIHJlbmRlcigpO1xuXG59XG5cbmZ1bmN0aW9uIHJlbmRlcigpIHtcblxuICB2YXIgdGltZXIgPSAwLjAwMDEgKiBEYXRlLm5vdygpO1xuXG4gIGZvciAoIHZhciBpID0gMCwgaWwgPSBzcGhlcmVzLmxlbmd0aDsgaSA8IGlsOyBpICsrICkge1xuXG4gICAgdmFyIHNwaGVyZSA9IHNwaGVyZXNbIGkgXTtcblxuICAgIHNwaGVyZS5wb3NpdGlvbi54ID0gcnggKiBNYXRoLmNvcyggdGltZXIgKyBpICk7XG4gICAgc3BoZXJlLnBvc2l0aW9uLnkgPSByeSAqIE1hdGguc2luKCB0aW1lciArIGkgKiAxLjEgKTtcblxuICB9XG5cbiAgY2FtZXJhLnBvc2l0aW9uLnggKz0gKCBtb3VzZVggLSBjYW1lcmEucG9zaXRpb24ueCApICogMC4wNTtcbiAgY2FtZXJhLnBvc2l0aW9uLnkgKz0gKCAtIG1vdXNlWSAtIGNhbWVyYS5wb3NpdGlvbi55ICkgKiAwLjA1O1xuXG4gIGNhbWVyYS5sb29rQXQoIHNjZW5lLnBvc2l0aW9uICk7XG4gIGNhbWVyYUN1YmUucm90YXRpb24uY29weSggY2FtZXJhLnJvdGF0aW9uICk7XG5cbiAgcmVuZGVyZXIucmVuZGVyKCBzY2VuZUN1YmUsIGNhbWVyYUN1YmUgKTtcbiAgcmVuZGVyZXIucmVuZGVyKCBzY2VuZSwgY2FtZXJhICk7XG5cbn1cblxuXG4kKGRvY3VtZW50KS5vbigncmVhZHlGb3JDYW52YXMnLCBmdW5jdGlvbihldmVudCkge1xuICBjb25zb2xlLmxvZyhcInJlYWR5Rm9yQ2FudmFzXCIpO1xuICBpbml0KCk7XG4gIGFuaW1hdGUoKTtcbiAgJChcIiNjYW52YXNcIikub24oICdtb3VzZW1vdmUnLCBvbkRvY3VtZW50TW91c2VNb3ZlICk7XG59KTtcblxuJChkb2N1bWVudCkub24oJ3JvdGF0aW9uVmFsdWVDaGFuZ2VkJywgZnVuY3Rpb24oZXZlbnQsIHgsIHkpIHtcbiAgY29uc29sZS5sb2coJ3JvdGF0aW9uVmFsdWVDaGFuZ2VkOiAnICsgeCArICcsICcgKyB5KTtcbiAgcnggPSB4O1xuICByeSA9IHk7XG59KTtcbiIsIlxuJ3VzZSBzdHJpY3QnO1xuXG52YXIgbWFpbiA9IGFuZ3VsYXIubW9kdWxlKCdjdE1haW4nLCBbXSk7XG5cbm1haW4uY29udHJvbGxlcignTWFpbkNvbnRyb2xsZXInLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSkge1xuICAkKGRvY3VtZW50KS50cmlnZ2VyKCdyZWFkeUZvckNhbnZhcycpO1xuXG4gICRzY29wZS51cGRhdGVSb3RhdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgIGNvbnNvbGUubG9nKFwib25DbGlja1JvdGF0aW9uQ2hhbmdlZFwiKTtcbiAgICAkKGRvY3VtZW50KS50cmlnZ2VyKCdyb3RhdGlvblZhbHVlQ2hhbmdlZCcsIFtwYXJzZUludCgkc2NvcGUucm90YXRpb24ueCksIHBhcnNlSW50KCRzY29wZS5yb3RhdGlvbi55KV0pO1xuICB9O1xufV0pO1xuIiwiIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
