'use strict';

/* App Module */

var ctApp = angular.module('ctApp', [
  'ngRoute',
  'ctMain',
]);

ctApp.config(['$routeProvider',
  function($routeProvider) {
    $routeProvider.
      when('/', {
        templateUrl: 'components/Main/main.html',
        controller: 'MainController'
      }).
      otherwise({
        redirectTo: '/'
      });
  }]);


var container;

var camera, scene, renderer;
var cameraCube, sceneCube;

var mesh, lightMesh, geometry;
var spheres = [];

var directionalLight, pointLight;

var mouseX = 0;
var mouseY = 0;

var rx = 5000;
var ry = 5000;

var windowHalfX = 640 / 2;
var windowHalfY = 480 / 2;


function init() {

  container = $('#main');

  camera = new THREE.PerspectiveCamera( 60, 640/480, 1, 100000 );
  camera.position.z = 3200;

  cameraCube = new THREE.PerspectiveCamera( 60, 640/480, 1, 100000 );

  scene = new THREE.Scene();
  sceneCube = new THREE.Scene();

  var geometry = new THREE.SphereBufferGeometry( 100, 32, 16 );

  var path = "assets/images/pisa/";
  var format = '.png';
  var urls = [
    path + 'px' + format, path + 'nx' + format,
    path + 'py' + format, path + 'ny' + format,
    path + 'pz' + format, path + 'nz' + format
  ];

  var textureCube = new THREE.CubeTextureLoader().load( urls );
  var material = new THREE.MeshBasicMaterial( { color: 0xffffff, envMap: textureCube } );

  for ( var i = 0; i < 500; i ++ ) {

    var mesh = new THREE.Mesh( geometry, material );

    mesh.position.x = Math.random() * 10000 - 5000;
    mesh.position.y = Math.random() * 10000 - 5000;
    mesh.position.z = Math.random() * 10000 - 5000;

    mesh.scale.x = mesh.scale.y = mesh.scale.z = Math.random() * 3 + 1;

    scene.add( mesh );

    spheres.push( mesh );

  }

  // Skybox

  var shader = THREE.ShaderLib[ "cube" ];
  shader.uniforms[ "tCube" ].value = textureCube;

  var material = new THREE.ShaderMaterial( {

    fragmentShader: shader.fragmentShader,
    vertexShader: shader.vertexShader,
    uniforms: shader.uniforms,
    depthWrite: false,
    side: THREE.BackSide

  } ),

  mesh = new THREE.Mesh( new THREE.BoxGeometry( 100, 100, 100 ), material );
  sceneCube.add( mesh );

  //

  renderer = new THREE.WebGLRenderer();
  renderer.setPixelRatio( window.devicePixelRatio );
  renderer.setSize( 640, 480 );
  renderer.autoClear = false;
  renderer.domElement.setAttribute('id', 'canvas');
  container.append( renderer.domElement );

  //

  window.addEventListener( 'resize', onWindowResize, false );

}

function onWindowResize() {

  windowHalfX = 640 / 2;
  windowHalfY = 480 / 2;

  camera.aspect = 640/480;
  camera.updateProjectionMatrix();

  cameraCube.aspect = 640/480;
  cameraCube.updateProjectionMatrix();


  renderer.setSize( 640, 480 );

}

function onDocumentMouseMove( event ) {

  mouseX = ( event.clientX - 640 ) * 10;
  mouseY = ( event.clientY - 480 ) * 10;

}

function animate() {

  requestAnimationFrame( animate );

  render();

}

function render() {

  var timer = 0.0001 * Date.now();

  for ( var i = 0, il = spheres.length; i < il; i ++ ) {

    var sphere = spheres[ i ];

    sphere.position.x = rx * Math.cos( timer + i );
    sphere.position.y = ry * Math.sin( timer + i * 1.1 );

  }

  camera.position.x += ( mouseX - camera.position.x ) * 0.05;
  camera.position.y += ( - mouseY - camera.position.y ) * 0.05;

  camera.lookAt( scene.position );
  cameraCube.rotation.copy( camera.rotation );

  renderer.render( sceneCube, cameraCube );
  renderer.render( scene, camera );

}


$(document).on('readyForCanvas', function(event) {
  console.log("readyForCanvas");
  init();
  animate();
  $("#canvas").on( 'mousemove', onDocumentMouseMove );
});

$(document).on('rotationValueChanged', function(event, x, y) {
  console.log('rotationValueChanged: ' + x + ', ' + y);
  rx = x;
  ry = y;
});


var container;

var camera, sceneFirstPass, sceneSecondPass, renderer;
var rtTexture;
var cubeTexture;
var transferTexture;

var materialFirstPass, materialSecondPass;

var mesh, geometry;
var spheres = [];

var vertexShader1, fragmentShader1;
var vertexShader2, fragmentShader2;

var screenSize = {x: 640, y: 480};
var windowHalfX = screenSize.x / 2;
var windowHalfY = screenSize.y / 2;

function loadResource(url, callback) {
  $.ajax({
    url: url,
    success: function(data) {
      return callback(null, data);
    },
    error: function(err) {
      return callback(err, null);
    }
  });
}

// Load shaders
function loadShaders() {
  console.log("HELLO");
  loadResource('/assets/shaders/raycaster.firstpass.vs', function(err, data) {
    if(err) {
      console.log(err);
    }
    vertexShader1 = data;

    loadResource('/assets/shaders/raycaster.firstpass.fs', function(err, data) {
      if(err) {
        console.log(err);
      }
      fragmentShader1 = data;

      loadResource('/assets/shaders/raycaster.secondpass.vs', function(err, data) {
        if(err) {
          console.log(err);
        }
        vertexShader2 = data;

        loadResource('/assets/shaders/raycaster.secondpass.fs', function(err, data) {
          if(err) {
            console.log(err);
          }
          fragmentShader2 = data;
          init();
        });
      });
    });
  });
}


function init() {

  container = $('#main');

  camera = new THREE.PerspectiveCamera( 60, screenSize.x/screenSize.y, 0.1, 100000 );
  camera.position.z = 2;

  sceneFirstPass = new THREE.Scene();
	sceneSecondPass = new THREE.Scene();

  cubeTexture = THREE.ImageUtils.loadTexture('/assets/images/bonsai.raw.png' );
  cubeTexture.generateMipmaps = false;
  cubeTexture.minFilter = THREE.LinearFilter;
  cubeTexture.magFilter = THREE.LinearFilter;

  transferTexture = updateTransferFunction();

  rtTexture = new THREE.WebGLRenderTarget( screenSize.x, screenSize.y,
														{ 	minFilter: THREE.LinearFilter,
															magFilter: THREE.LinearFilter,
															wrapS:  THREE.ClampToEdgeWrapping,
															wrapT:  THREE.ClampToEdgeWrapping,
															format: THREE.RGBFormat,
															type: THREE.FloatType,
															generateMipmaps: false} );


  materialFirstPass = new THREE.ShaderMaterial( {
  	vertexShader: vertexShader1,
  	fragmentShader: fragmentShader1,
  	side: THREE.BackSide
  } );

	materialSecondPass = new THREE.ShaderMaterial( {
  	vertexShader: vertexShader2,
  	fragmentShader: fragmentShader2,
		side: THREE.FrontSide,
		uniforms: {
      tex:  {
        type: "t",
        value: rtTexture
      },
			cubeTex:
      {
        type: "t",
        value: cubeTexture
      },
			transferTex:
      {
        type: "t",
        value: transferTexture
      },
			steps : {
        type: "1f" ,
        value: 256
      },
			alphaCorrection : {
        type: "1f" ,
        value: 1.0
      }
    }
	 });


  // Geometry setup
	var boxGeometry = new THREE.BoxGeometry(1.0, 1.0, 1.0);
	boxGeometry.doubleSided = true;
	var meshFirstPass = new THREE.Mesh( boxGeometry, materialFirstPass );
	var meshSecondPass = new THREE.Mesh( boxGeometry, materialSecondPass );
	sceneFirstPass.add( meshFirstPass );
	sceneSecondPass.add( meshSecondPass );


  renderer = new THREE.WebGLRenderer();
  renderer.setPixelRatio( window.devicePixelRatio );
  renderer.setSize( screenSize.x, screenSize.y );
  renderer.autoClear = true;
  renderer.setClearColor("#FFFFFF");
  console.log("clear color: ");
  console.log(renderer.getClearColor());
  renderer.domElement.setAttribute('id', 'canvas');
  container.append( renderer.domElement );

  var b = new THREE.BoxGeometry(2,2,2);
  var bmat = new THREE.MeshBasicMaterial({color: "#FF0000"});

  var bmesh = new THREE.Mesh(b, bmat);
  bmesh.position.x = 0;
  bmesh.position.y = 0;
  bmesh.position.z = 0;

  //sceneSecondPass.add(bmesh);

  window.addEventListener( 'resize', onWindowResize, false );

  animate();
}

function onWindowResize() {

  windowHalfX = screenSize.x / 2;
  windowHalfY = screenSize.y / 2;

  camera.aspect = screenSize.x/screenSize.y;
  camera.updateProjectionMatrix();

  renderer.setSize( screenSize.x, screenSize.y );

}


function animate() {

  requestAnimationFrame( animate );

  render();

}

function render() {

  //var delta = clock.getDelta();
	//Render first pass and store the world space coords of the back face fragments into the texture.
	renderer.render( sceneFirstPass, camera, rtTexture, true );
	//Render the second pass and perform the volume rendering.
	renderer.render( sceneSecondPass, camera );
	materialSecondPass.uniforms.steps.value = 256;
	materialSecondPass.uniforms.alphaCorrection.value = 1.0;

}

function updateTextures(value) {
  materialSecondPass.uniforms.transferTex.value = updateTransferFunction();
}

function updateTransferFunction() {
	var canvas = document.createElement('canvas');
	canvas.height = 20;
	canvas.width = 256;
	var ctx = canvas.getContext('2d');
	var grd = ctx.createLinearGradient(0, 0, canvas.width -1 , canvas.height - 1);
	grd.addColorStop(0.1, "#00FF00");
	grd.addColorStop(0.7, "#FF0000");
	grd.addColorStop(1.0, "#0000FF");
	ctx.fillStyle = grd;
	ctx.fillRect(0,0,canvas.width -1 ,canvas.height -1 );

  var img = document.getElementById("transferTexture");
				img.src = canvas.toDataURL();
				img.style.width = "256 px";
				img.style.height = "128 px";

	transferTexture =  new THREE.Texture(canvas);
	transferTexture.wrapS = transferTexture.wrapT =  THREE.ClampToEdgeWrapping;
	transferTexture.needsUpdate = true;
	return transferTexture;
}


$(document).on('readyForCanvasRaycaster', function(event) {
  console.log("readyForCanvasRaycaster");
  loadShaders();
  $("#canvas").on( 'mousemove', onDocumentMouseMove );
});

$(document).on('rotationValueChanged', function(event, x, y) {
  console.log('rotationValueChanged: ' + x + ', ' + y);
  rx = x;
  ry = y;
});


'use strict';

var main = angular.module('ctMain', []);

main.controller('MainController', ['$scope', function($scope) {
  $(document).trigger('readyForCanvasRaycaster');

  $scope.updateRotation = function() {
    console.log("onClickRotationChanged");
    $(document).trigger('rotationValueChanged', [parseInt($scope.rotation.x), parseInt($scope.rotation.y)]);
  };

  var randomdata = [];
  for( var i = 0; i < 20; i++) {
    randomdata[i] = [];
    for( var j = 0; j < 100; j++) {
      randomdata[i][j] = [];
      for( var k = 0; k < 100; k++) {
        randomdata[i][j].push(Math.floor(Math.random()*4096));
      }
    }
  }
  console.log("Hello mosaic");
  $("#test").append(mosaic.createMosaicImage(100, 100, randomdata));
}]);


var mosaic = {};

mosaic.createOneImage = function(sizex, sizey, data) {
	var canvas = document.createElement("canvas");
	canvas.setAttribute("width", sizex);
	canvas.setAttribute("height", sizey);
	var ctx = canvas.getContext('2d');
	console.log("one img data length: " + data.length);

	for(var i = 0; i < data.length; i++) {
		for(var j = 0; j < data[0].length; j++) {
			var id = ctx.createImageData(1,1);
			// Use bitmask for spliting the uint16 value into two uint8 to fit into img
			id.data[0] = data[i][j] & 0xFF00;	// r
			id.data[1] = data[i][j] & 0x00FF;	// g
			id.data[2] = 0;	// b
			id.data[3] = 255;	// a
			ctx.putImageData(id, j, i); // row based, so add to x=j, y=i
		//	console.log("R: " + p[0] + " G:" + p[1]);
		}
	}

	var image = new Image();
	image.src = canvas.toDataURL("/image/png");
	return image;
}

mosaic.createMosaicImage = function(sizex, sizey, data) {
	var canvas = document.createElement("canvas");
	canvas.setAttribute("width", data[0].length*sizex);
	canvas.setAttribute("height", sizey);
	var ctx = canvas.getContext('2d');
	var imgarr = [];
	for(var i = 0; i < data.length; i++) {
		console.log("data[i]: " + data[i].length);
		imgarr.push(this.createOneImage(sizex, sizey, data[i]));
		ctx.drawImage(imgarr[i], sizex*i, 0, sizex, sizey);
	}
	var img = new Image();
	img.src = canvas.toDataURL("/image/png");
	console.log("Finished reading and creating img");
	return img;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsInRocmVlanMvZXhhbXBsZS5qcyIsInRocmVlanMvcmF5Y2FzdGVyLmpzIiwiY29tcG9uZW50cy9NYWluL21haW5Db250cm9sbGVyLmpzIiwidGhyZWVqcy91dGlscy9jcmVhdGVNb3NhaWNJbWFnZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7OztBQUlBLElBQUEsUUFBQSxRQUFBLE9BQUEsU0FBQTtFQUNBO0VBQ0E7OztBQUdBLE1BQUEsT0FBQSxDQUFBO0VBQ0EsU0FBQSxnQkFBQTtJQUNBO01BQ0EsS0FBQSxLQUFBO1FBQ0EsYUFBQTtRQUNBLFlBQUE7O01BRUEsVUFBQTtRQUNBLFlBQUE7Ozs7O0FDaEJBLElBQUE7O0FBRUEsSUFBQSxRQUFBLE9BQUE7QUFDQSxJQUFBLFlBQUE7O0FBRUEsSUFBQSxNQUFBLFdBQUE7QUFDQSxJQUFBLFVBQUE7O0FBRUEsSUFBQSxrQkFBQTs7QUFFQSxJQUFBLFNBQUE7QUFDQSxJQUFBLFNBQUE7O0FBRUEsSUFBQSxLQUFBO0FBQ0EsSUFBQSxLQUFBOztBQUVBLElBQUEsY0FBQSxNQUFBO0FBQ0EsSUFBQSxjQUFBLE1BQUE7OztBQUdBLFNBQUEsT0FBQTs7RUFFQSxZQUFBLEVBQUE7O0VBRUEsU0FBQSxJQUFBLE1BQUEsbUJBQUEsSUFBQSxJQUFBLEtBQUEsR0FBQTtFQUNBLE9BQUEsU0FBQSxJQUFBOztFQUVBLGFBQUEsSUFBQSxNQUFBLG1CQUFBLElBQUEsSUFBQSxLQUFBLEdBQUE7O0VBRUEsUUFBQSxJQUFBLE1BQUE7RUFDQSxZQUFBLElBQUEsTUFBQTs7RUFFQSxJQUFBLFdBQUEsSUFBQSxNQUFBLHNCQUFBLEtBQUEsSUFBQTs7RUFFQSxJQUFBLE9BQUE7RUFDQSxJQUFBLFNBQUE7RUFDQSxJQUFBLE9BQUE7SUFDQSxPQUFBLE9BQUEsUUFBQSxPQUFBLE9BQUE7SUFDQSxPQUFBLE9BQUEsUUFBQSxPQUFBLE9BQUE7SUFDQSxPQUFBLE9BQUEsUUFBQSxPQUFBLE9BQUE7OztFQUdBLElBQUEsY0FBQSxJQUFBLE1BQUEsb0JBQUEsTUFBQTtFQUNBLElBQUEsV0FBQSxJQUFBLE1BQUEsbUJBQUEsRUFBQSxPQUFBLFVBQUEsUUFBQTs7RUFFQSxNQUFBLElBQUEsSUFBQSxHQUFBLElBQUEsS0FBQSxPQUFBOztJQUVBLElBQUEsT0FBQSxJQUFBLE1BQUEsTUFBQSxVQUFBOztJQUVBLEtBQUEsU0FBQSxJQUFBLEtBQUEsV0FBQSxRQUFBO0lBQ0EsS0FBQSxTQUFBLElBQUEsS0FBQSxXQUFBLFFBQUE7SUFDQSxLQUFBLFNBQUEsSUFBQSxLQUFBLFdBQUEsUUFBQTs7SUFFQSxLQUFBLE1BQUEsSUFBQSxLQUFBLE1BQUEsSUFBQSxLQUFBLE1BQUEsSUFBQSxLQUFBLFdBQUEsSUFBQTs7SUFFQSxNQUFBLEtBQUE7O0lBRUEsUUFBQSxNQUFBOzs7Ozs7RUFNQSxJQUFBLFNBQUEsTUFBQSxXQUFBO0VBQ0EsT0FBQSxVQUFBLFVBQUEsUUFBQTs7RUFFQSxJQUFBLFdBQUEsSUFBQSxNQUFBLGdCQUFBOztJQUVBLGdCQUFBLE9BQUE7SUFDQSxjQUFBLE9BQUE7SUFDQSxVQUFBLE9BQUE7SUFDQSxZQUFBO0lBQ0EsTUFBQSxNQUFBOzs7O0VBSUEsT0FBQSxJQUFBLE1BQUEsTUFBQSxJQUFBLE1BQUEsYUFBQSxLQUFBLEtBQUEsT0FBQTtFQUNBLFVBQUEsS0FBQTs7OztFQUlBLFdBQUEsSUFBQSxNQUFBO0VBQ0EsU0FBQSxlQUFBLE9BQUE7RUFDQSxTQUFBLFNBQUEsS0FBQTtFQUNBLFNBQUEsWUFBQTtFQUNBLFNBQUEsV0FBQSxhQUFBLE1BQUE7RUFDQSxVQUFBLFFBQUEsU0FBQTs7OztFQUlBLE9BQUEsa0JBQUEsVUFBQSxnQkFBQTs7OztBQUlBLFNBQUEsaUJBQUE7O0VBRUEsY0FBQSxNQUFBO0VBQ0EsY0FBQSxNQUFBOztFQUVBLE9BQUEsU0FBQSxJQUFBO0VBQ0EsT0FBQTs7RUFFQSxXQUFBLFNBQUEsSUFBQTtFQUNBLFdBQUE7OztFQUdBLFNBQUEsU0FBQSxLQUFBOzs7O0FBSUEsU0FBQSxxQkFBQSxRQUFBOztFQUVBLFNBQUEsRUFBQSxNQUFBLFVBQUEsUUFBQTtFQUNBLFNBQUEsRUFBQSxNQUFBLFVBQUEsUUFBQTs7OztBQUlBLFNBQUEsVUFBQTs7RUFFQSx1QkFBQTs7RUFFQTs7OztBQUlBLFNBQUEsU0FBQTs7RUFFQSxJQUFBLFFBQUEsU0FBQSxLQUFBOztFQUVBLE1BQUEsSUFBQSxJQUFBLEdBQUEsS0FBQSxRQUFBLFFBQUEsSUFBQSxJQUFBLE9BQUE7O0lBRUEsSUFBQSxTQUFBLFNBQUE7O0lBRUEsT0FBQSxTQUFBLElBQUEsS0FBQSxLQUFBLEtBQUEsUUFBQTtJQUNBLE9BQUEsU0FBQSxJQUFBLEtBQUEsS0FBQSxLQUFBLFFBQUEsSUFBQTs7OztFQUlBLE9BQUEsU0FBQSxLQUFBLEVBQUEsU0FBQSxPQUFBLFNBQUEsTUFBQTtFQUNBLE9BQUEsU0FBQSxLQUFBLEVBQUEsRUFBQSxTQUFBLE9BQUEsU0FBQSxNQUFBOztFQUVBLE9BQUEsUUFBQSxNQUFBO0VBQ0EsV0FBQSxTQUFBLE1BQUEsT0FBQTs7RUFFQSxTQUFBLFFBQUEsV0FBQTtFQUNBLFNBQUEsUUFBQSxPQUFBOzs7OztBQUtBLEVBQUEsVUFBQSxHQUFBLGtCQUFBLFNBQUEsT0FBQTtFQUNBLFFBQUEsSUFBQTtFQUNBO0VBQ0E7RUFDQSxFQUFBLFdBQUEsSUFBQSxhQUFBOzs7QUFHQSxFQUFBLFVBQUEsR0FBQSx3QkFBQSxTQUFBLE9BQUEsR0FBQSxHQUFBO0VBQ0EsUUFBQSxJQUFBLDJCQUFBLElBQUEsT0FBQTtFQUNBLEtBQUE7RUFDQSxLQUFBOzs7O0FDaEtBLElBQUE7O0FBRUEsSUFBQSxRQUFBLGdCQUFBLGlCQUFBO0FBQ0EsSUFBQTtBQUNBLElBQUE7QUFDQSxJQUFBOztBQUVBLElBQUEsbUJBQUE7O0FBRUEsSUFBQSxNQUFBO0FBQ0EsSUFBQSxVQUFBOztBQUVBLElBQUEsZUFBQTtBQUNBLElBQUEsZUFBQTs7QUFFQSxJQUFBLGFBQUEsQ0FBQSxHQUFBLEtBQUEsR0FBQTtBQUNBLElBQUEsY0FBQSxXQUFBLElBQUE7QUFDQSxJQUFBLGNBQUEsV0FBQSxJQUFBOztBQUVBLFNBQUEsYUFBQSxLQUFBLFVBQUE7RUFDQSxFQUFBLEtBQUE7SUFDQSxLQUFBO0lBQ0EsU0FBQSxTQUFBLE1BQUE7TUFDQSxPQUFBLFNBQUEsTUFBQTs7SUFFQSxPQUFBLFNBQUEsS0FBQTtNQUNBLE9BQUEsU0FBQSxLQUFBOzs7Ozs7QUFNQSxTQUFBLGNBQUE7RUFDQSxRQUFBLElBQUE7RUFDQSxhQUFBLDBDQUFBLFNBQUEsS0FBQSxNQUFBO0lBQ0EsR0FBQSxLQUFBO01BQ0EsUUFBQSxJQUFBOztJQUVBLGdCQUFBOztJQUVBLGFBQUEsMENBQUEsU0FBQSxLQUFBLE1BQUE7TUFDQSxHQUFBLEtBQUE7UUFDQSxRQUFBLElBQUE7O01BRUEsa0JBQUE7O01BRUEsYUFBQSwyQ0FBQSxTQUFBLEtBQUEsTUFBQTtRQUNBLEdBQUEsS0FBQTtVQUNBLFFBQUEsSUFBQTs7UUFFQSxnQkFBQTs7UUFFQSxhQUFBLDJDQUFBLFNBQUEsS0FBQSxNQUFBO1VBQ0EsR0FBQSxLQUFBO1lBQ0EsUUFBQSxJQUFBOztVQUVBLGtCQUFBO1VBQ0E7Ozs7Ozs7O0FBUUEsU0FBQSxPQUFBOztFQUVBLFlBQUEsRUFBQTs7RUFFQSxTQUFBLElBQUEsTUFBQSxtQkFBQSxJQUFBLFdBQUEsRUFBQSxXQUFBLEdBQUEsS0FBQTtFQUNBLE9BQUEsU0FBQSxJQUFBOztFQUVBLGlCQUFBLElBQUEsTUFBQTtDQUNBLGtCQUFBLElBQUEsTUFBQTs7RUFFQSxjQUFBLE1BQUEsV0FBQSxZQUFBO0VBQ0EsWUFBQSxrQkFBQTtFQUNBLFlBQUEsWUFBQSxNQUFBO0VBQ0EsWUFBQSxZQUFBLE1BQUE7O0VBRUEsa0JBQUE7O0VBRUEsWUFBQSxJQUFBLE1BQUEsbUJBQUEsV0FBQSxHQUFBLFdBQUE7Y0FDQSxHQUFBLFdBQUEsTUFBQTtlQUNBLFdBQUEsTUFBQTtlQUNBLFFBQUEsTUFBQTtlQUNBLFFBQUEsTUFBQTtlQUNBLFFBQUEsTUFBQTtlQUNBLE1BQUEsTUFBQTtlQUNBLGlCQUFBOzs7RUFHQSxvQkFBQSxJQUFBLE1BQUEsZ0JBQUE7R0FDQSxjQUFBO0dBQ0EsZ0JBQUE7R0FDQSxNQUFBLE1BQUE7OztDQUdBLHFCQUFBLElBQUEsTUFBQSxnQkFBQTtHQUNBLGNBQUE7R0FDQSxnQkFBQTtFQUNBLE1BQUEsTUFBQTtFQUNBLFVBQUE7TUFDQSxNQUFBO1FBQ0EsTUFBQTtRQUNBLE9BQUE7O0dBRUE7TUFDQTtRQUNBLE1BQUE7UUFDQSxPQUFBOztHQUVBO01BQ0E7UUFDQSxNQUFBO1FBQ0EsT0FBQTs7R0FFQSxRQUFBO1FBQ0EsTUFBQTtRQUNBLE9BQUE7O0dBRUEsa0JBQUE7UUFDQSxNQUFBO1FBQ0EsT0FBQTs7Ozs7OztDQU9BLElBQUEsY0FBQSxJQUFBLE1BQUEsWUFBQSxLQUFBLEtBQUE7Q0FDQSxZQUFBLGNBQUE7Q0FDQSxJQUFBLGdCQUFBLElBQUEsTUFBQSxNQUFBLGFBQUE7Q0FDQSxJQUFBLGlCQUFBLElBQUEsTUFBQSxNQUFBLGFBQUE7Q0FDQSxlQUFBLEtBQUE7Q0FDQSxnQkFBQSxLQUFBOzs7RUFHQSxXQUFBLElBQUEsTUFBQTtFQUNBLFNBQUEsZUFBQSxPQUFBO0VBQ0EsU0FBQSxTQUFBLFdBQUEsR0FBQSxXQUFBO0VBQ0EsU0FBQSxZQUFBO0VBQ0EsU0FBQSxjQUFBO0VBQ0EsUUFBQSxJQUFBO0VBQ0EsUUFBQSxJQUFBLFNBQUE7RUFDQSxTQUFBLFdBQUEsYUFBQSxNQUFBO0VBQ0EsVUFBQSxRQUFBLFNBQUE7O0VBRUEsSUFBQSxJQUFBLElBQUEsTUFBQSxZQUFBLEVBQUEsRUFBQTtFQUNBLElBQUEsT0FBQSxJQUFBLE1BQUEsa0JBQUEsQ0FBQSxPQUFBOztFQUVBLElBQUEsUUFBQSxJQUFBLE1BQUEsS0FBQSxHQUFBO0VBQ0EsTUFBQSxTQUFBLElBQUE7RUFDQSxNQUFBLFNBQUEsSUFBQTtFQUNBLE1BQUEsU0FBQSxJQUFBOzs7O0VBSUEsT0FBQSxrQkFBQSxVQUFBLGdCQUFBOztFQUVBOzs7QUFHQSxTQUFBLGlCQUFBOztFQUVBLGNBQUEsV0FBQSxJQUFBO0VBQ0EsY0FBQSxXQUFBLElBQUE7O0VBRUEsT0FBQSxTQUFBLFdBQUEsRUFBQSxXQUFBO0VBQ0EsT0FBQTs7RUFFQSxTQUFBLFNBQUEsV0FBQSxHQUFBLFdBQUE7Ozs7O0FBS0EsU0FBQSxVQUFBOztFQUVBLHVCQUFBOztFQUVBOzs7O0FBSUEsU0FBQSxTQUFBOzs7O0NBSUEsU0FBQSxRQUFBLGdCQUFBLFFBQUEsV0FBQTs7Q0FFQSxTQUFBLFFBQUEsaUJBQUE7Q0FDQSxtQkFBQSxTQUFBLE1BQUEsUUFBQTtDQUNBLG1CQUFBLFNBQUEsZ0JBQUEsUUFBQTs7OztBQUlBLFNBQUEsZUFBQSxPQUFBO0VBQ0EsbUJBQUEsU0FBQSxZQUFBLFFBQUE7OztBQUdBLFNBQUEseUJBQUE7Q0FDQSxJQUFBLFNBQUEsU0FBQSxjQUFBO0NBQ0EsT0FBQSxTQUFBO0NBQ0EsT0FBQSxRQUFBO0NBQ0EsSUFBQSxNQUFBLE9BQUEsV0FBQTtDQUNBLElBQUEsTUFBQSxJQUFBLHFCQUFBLEdBQUEsR0FBQSxPQUFBLE9BQUEsSUFBQSxPQUFBLFNBQUE7Q0FDQSxJQUFBLGFBQUEsS0FBQTtDQUNBLElBQUEsYUFBQSxLQUFBO0NBQ0EsSUFBQSxhQUFBLEtBQUE7Q0FDQSxJQUFBLFlBQUE7Q0FDQSxJQUFBLFNBQUEsRUFBQSxFQUFBLE9BQUEsT0FBQSxHQUFBLE9BQUEsUUFBQTs7RUFFQSxJQUFBLE1BQUEsU0FBQSxlQUFBO0lBQ0EsSUFBQSxNQUFBLE9BQUE7SUFDQSxJQUFBLE1BQUEsUUFBQTtJQUNBLElBQUEsTUFBQSxTQUFBOztDQUVBLG1CQUFBLElBQUEsTUFBQSxRQUFBO0NBQ0EsZ0JBQUEsUUFBQSxnQkFBQSxTQUFBLE1BQUE7Q0FDQSxnQkFBQSxjQUFBO0NBQ0EsT0FBQTs7OztBQUlBLEVBQUEsVUFBQSxHQUFBLDJCQUFBLFNBQUEsT0FBQTtFQUNBLFFBQUEsSUFBQTtFQUNBO0VBQ0EsRUFBQSxXQUFBLElBQUEsYUFBQTs7O0FBR0EsRUFBQSxVQUFBLEdBQUEsd0JBQUEsU0FBQSxPQUFBLEdBQUEsR0FBQTtFQUNBLFFBQUEsSUFBQSwyQkFBQSxJQUFBLE9BQUE7RUFDQSxLQUFBO0VBQ0EsS0FBQTs7OztBQ3pPQTs7QUFFQSxJQUFBLE9BQUEsUUFBQSxPQUFBLFVBQUE7O0FBRUEsS0FBQSxXQUFBLGtCQUFBLENBQUEsVUFBQSxTQUFBLFFBQUE7RUFDQSxFQUFBLFVBQUEsUUFBQTs7RUFFQSxPQUFBLGlCQUFBLFdBQUE7SUFDQSxRQUFBLElBQUE7SUFDQSxFQUFBLFVBQUEsUUFBQSx3QkFBQSxDQUFBLFNBQUEsT0FBQSxTQUFBLElBQUEsU0FBQSxPQUFBLFNBQUE7OztFQUdBLElBQUEsYUFBQTtFQUNBLEtBQUEsSUFBQSxJQUFBLEdBQUEsSUFBQSxJQUFBLEtBQUE7SUFDQSxXQUFBLEtBQUE7SUFDQSxLQUFBLElBQUEsSUFBQSxHQUFBLElBQUEsS0FBQSxLQUFBO01BQ0EsV0FBQSxHQUFBLEtBQUE7TUFDQSxLQUFBLElBQUEsSUFBQSxHQUFBLElBQUEsS0FBQSxLQUFBO1FBQ0EsV0FBQSxHQUFBLEdBQUEsS0FBQSxLQUFBLE1BQUEsS0FBQSxTQUFBOzs7O0VBSUEsUUFBQSxJQUFBO0VBQ0EsRUFBQSxTQUFBLE9BQUEsT0FBQSxrQkFBQSxLQUFBLEtBQUE7Ozs7QUN4QkEsSUFBQSxTQUFBOztBQUVBLE9BQUEsaUJBQUEsU0FBQSxPQUFBLE9BQUEsTUFBQTtDQUNBLElBQUEsU0FBQSxTQUFBLGNBQUE7Q0FDQSxPQUFBLGFBQUEsU0FBQTtDQUNBLE9BQUEsYUFBQSxVQUFBO0NBQ0EsSUFBQSxNQUFBLE9BQUEsV0FBQTtDQUNBLFFBQUEsSUFBQSwwQkFBQSxLQUFBOztDQUVBLElBQUEsSUFBQSxJQUFBLEdBQUEsSUFBQSxLQUFBLFFBQUEsS0FBQTtFQUNBLElBQUEsSUFBQSxJQUFBLEdBQUEsSUFBQSxLQUFBLEdBQUEsUUFBQSxLQUFBO0dBQ0EsSUFBQSxLQUFBLElBQUEsZ0JBQUEsRUFBQTs7R0FFQSxHQUFBLEtBQUEsS0FBQSxLQUFBLEdBQUEsS0FBQTtHQUNBLEdBQUEsS0FBQSxLQUFBLEtBQUEsR0FBQSxLQUFBO0dBQ0EsR0FBQSxLQUFBLEtBQUE7R0FDQSxHQUFBLEtBQUEsS0FBQTtHQUNBLElBQUEsYUFBQSxJQUFBLEdBQUE7Ozs7O0NBS0EsSUFBQSxRQUFBLElBQUE7Q0FDQSxNQUFBLE1BQUEsT0FBQSxVQUFBO0NBQ0EsT0FBQTs7O0FBR0EsT0FBQSxvQkFBQSxTQUFBLE9BQUEsT0FBQSxNQUFBO0NBQ0EsSUFBQSxTQUFBLFNBQUEsY0FBQTtDQUNBLE9BQUEsYUFBQSxTQUFBLEtBQUEsR0FBQSxPQUFBO0NBQ0EsT0FBQSxhQUFBLFVBQUE7Q0FDQSxJQUFBLE1BQUEsT0FBQSxXQUFBO0NBQ0EsSUFBQSxTQUFBO0NBQ0EsSUFBQSxJQUFBLElBQUEsR0FBQSxJQUFBLEtBQUEsUUFBQSxLQUFBO0VBQ0EsUUFBQSxJQUFBLGNBQUEsS0FBQSxHQUFBO0VBQ0EsT0FBQSxLQUFBLEtBQUEsZUFBQSxPQUFBLE9BQUEsS0FBQTtFQUNBLElBQUEsVUFBQSxPQUFBLElBQUEsTUFBQSxHQUFBLEdBQUEsT0FBQTs7Q0FFQSxJQUFBLE1BQUEsSUFBQTtDQUNBLElBQUEsTUFBQSxPQUFBLFVBQUE7Q0FDQSxRQUFBLElBQUE7Q0FDQSxPQUFBOztBQUVBIiwiZmlsZSI6ImJ1bmRsZS5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbi8qIEFwcCBNb2R1bGUgKi9cblxudmFyIGN0QXBwID0gYW5ndWxhci5tb2R1bGUoJ2N0QXBwJywgW1xuICAnbmdSb3V0ZScsXG4gICdjdE1haW4nLFxuXSk7XG5cbmN0QXBwLmNvbmZpZyhbJyRyb3V0ZVByb3ZpZGVyJyxcbiAgZnVuY3Rpb24oJHJvdXRlUHJvdmlkZXIpIHtcbiAgICAkcm91dGVQcm92aWRlci5cbiAgICAgIHdoZW4oJy8nLCB7XG4gICAgICAgIHRlbXBsYXRlVXJsOiAnY29tcG9uZW50cy9NYWluL21haW4uaHRtbCcsXG4gICAgICAgIGNvbnRyb2xsZXI6ICdNYWluQ29udHJvbGxlcidcbiAgICAgIH0pLlxuICAgICAgb3RoZXJ3aXNlKHtcbiAgICAgICAgcmVkaXJlY3RUbzogJy8nXG4gICAgICB9KTtcbiAgfV0pO1xuIiwiXG52YXIgY29udGFpbmVyO1xuXG52YXIgY2FtZXJhLCBzY2VuZSwgcmVuZGVyZXI7XG52YXIgY2FtZXJhQ3ViZSwgc2NlbmVDdWJlO1xuXG52YXIgbWVzaCwgbGlnaHRNZXNoLCBnZW9tZXRyeTtcbnZhciBzcGhlcmVzID0gW107XG5cbnZhciBkaXJlY3Rpb25hbExpZ2h0LCBwb2ludExpZ2h0O1xuXG52YXIgbW91c2VYID0gMDtcbnZhciBtb3VzZVkgPSAwO1xuXG52YXIgcnggPSA1MDAwO1xudmFyIHJ5ID0gNTAwMDtcblxudmFyIHdpbmRvd0hhbGZYID0gNjQwIC8gMjtcbnZhciB3aW5kb3dIYWxmWSA9IDQ4MCAvIDI7XG5cblxuZnVuY3Rpb24gaW5pdCgpIHtcblxuICBjb250YWluZXIgPSAkKCcjbWFpbicpO1xuXG4gIGNhbWVyYSA9IG5ldyBUSFJFRS5QZXJzcGVjdGl2ZUNhbWVyYSggNjAsIDY0MC80ODAsIDEsIDEwMDAwMCApO1xuICBjYW1lcmEucG9zaXRpb24ueiA9IDMyMDA7XG5cbiAgY2FtZXJhQ3ViZSA9IG5ldyBUSFJFRS5QZXJzcGVjdGl2ZUNhbWVyYSggNjAsIDY0MC80ODAsIDEsIDEwMDAwMCApO1xuXG4gIHNjZW5lID0gbmV3IFRIUkVFLlNjZW5lKCk7XG4gIHNjZW5lQ3ViZSA9IG5ldyBUSFJFRS5TY2VuZSgpO1xuXG4gIHZhciBnZW9tZXRyeSA9IG5ldyBUSFJFRS5TcGhlcmVCdWZmZXJHZW9tZXRyeSggMTAwLCAzMiwgMTYgKTtcblxuICB2YXIgcGF0aCA9IFwiYXNzZXRzL2ltYWdlcy9waXNhL1wiO1xuICB2YXIgZm9ybWF0ID0gJy5wbmcnO1xuICB2YXIgdXJscyA9IFtcbiAgICBwYXRoICsgJ3B4JyArIGZvcm1hdCwgcGF0aCArICdueCcgKyBmb3JtYXQsXG4gICAgcGF0aCArICdweScgKyBmb3JtYXQsIHBhdGggKyAnbnknICsgZm9ybWF0LFxuICAgIHBhdGggKyAncHonICsgZm9ybWF0LCBwYXRoICsgJ256JyArIGZvcm1hdFxuICBdO1xuXG4gIHZhciB0ZXh0dXJlQ3ViZSA9IG5ldyBUSFJFRS5DdWJlVGV4dHVyZUxvYWRlcigpLmxvYWQoIHVybHMgKTtcbiAgdmFyIG1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hCYXNpY01hdGVyaWFsKCB7IGNvbG9yOiAweGZmZmZmZiwgZW52TWFwOiB0ZXh0dXJlQ3ViZSB9ICk7XG5cbiAgZm9yICggdmFyIGkgPSAwOyBpIDwgNTAwOyBpICsrICkge1xuXG4gICAgdmFyIG1lc2ggPSBuZXcgVEhSRUUuTWVzaCggZ2VvbWV0cnksIG1hdGVyaWFsICk7XG5cbiAgICBtZXNoLnBvc2l0aW9uLnggPSBNYXRoLnJhbmRvbSgpICogMTAwMDAgLSA1MDAwO1xuICAgIG1lc2gucG9zaXRpb24ueSA9IE1hdGgucmFuZG9tKCkgKiAxMDAwMCAtIDUwMDA7XG4gICAgbWVzaC5wb3NpdGlvbi56ID0gTWF0aC5yYW5kb20oKSAqIDEwMDAwIC0gNTAwMDtcblxuICAgIG1lc2guc2NhbGUueCA9IG1lc2guc2NhbGUueSA9IG1lc2guc2NhbGUueiA9IE1hdGgucmFuZG9tKCkgKiAzICsgMTtcblxuICAgIHNjZW5lLmFkZCggbWVzaCApO1xuXG4gICAgc3BoZXJlcy5wdXNoKCBtZXNoICk7XG5cbiAgfVxuXG4gIC8vIFNreWJveFxuXG4gIHZhciBzaGFkZXIgPSBUSFJFRS5TaGFkZXJMaWJbIFwiY3ViZVwiIF07XG4gIHNoYWRlci51bmlmb3Jtc1sgXCJ0Q3ViZVwiIF0udmFsdWUgPSB0ZXh0dXJlQ3ViZTtcblxuICB2YXIgbWF0ZXJpYWwgPSBuZXcgVEhSRUUuU2hhZGVyTWF0ZXJpYWwoIHtcblxuICAgIGZyYWdtZW50U2hhZGVyOiBzaGFkZXIuZnJhZ21lbnRTaGFkZXIsXG4gICAgdmVydGV4U2hhZGVyOiBzaGFkZXIudmVydGV4U2hhZGVyLFxuICAgIHVuaWZvcm1zOiBzaGFkZXIudW5pZm9ybXMsXG4gICAgZGVwdGhXcml0ZTogZmFsc2UsXG4gICAgc2lkZTogVEhSRUUuQmFja1NpZGVcblxuICB9ICksXG5cbiAgbWVzaCA9IG5ldyBUSFJFRS5NZXNoKCBuZXcgVEhSRUUuQm94R2VvbWV0cnkoIDEwMCwgMTAwLCAxMDAgKSwgbWF0ZXJpYWwgKTtcbiAgc2NlbmVDdWJlLmFkZCggbWVzaCApO1xuXG4gIC8vXG5cbiAgcmVuZGVyZXIgPSBuZXcgVEhSRUUuV2ViR0xSZW5kZXJlcigpO1xuICByZW5kZXJlci5zZXRQaXhlbFJhdGlvKCB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyApO1xuICByZW5kZXJlci5zZXRTaXplKCA2NDAsIDQ4MCApO1xuICByZW5kZXJlci5hdXRvQ2xlYXIgPSBmYWxzZTtcbiAgcmVuZGVyZXIuZG9tRWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2lkJywgJ2NhbnZhcycpO1xuICBjb250YWluZXIuYXBwZW5kKCByZW5kZXJlci5kb21FbGVtZW50ICk7XG5cbiAgLy9cblxuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lciggJ3Jlc2l6ZScsIG9uV2luZG93UmVzaXplLCBmYWxzZSApO1xuXG59XG5cbmZ1bmN0aW9uIG9uV2luZG93UmVzaXplKCkge1xuXG4gIHdpbmRvd0hhbGZYID0gNjQwIC8gMjtcbiAgd2luZG93SGFsZlkgPSA0ODAgLyAyO1xuXG4gIGNhbWVyYS5hc3BlY3QgPSA2NDAvNDgwO1xuICBjYW1lcmEudXBkYXRlUHJvamVjdGlvbk1hdHJpeCgpO1xuXG4gIGNhbWVyYUN1YmUuYXNwZWN0ID0gNjQwLzQ4MDtcbiAgY2FtZXJhQ3ViZS51cGRhdGVQcm9qZWN0aW9uTWF0cml4KCk7XG5cblxuICByZW5kZXJlci5zZXRTaXplKCA2NDAsIDQ4MCApO1xuXG59XG5cbmZ1bmN0aW9uIG9uRG9jdW1lbnRNb3VzZU1vdmUoIGV2ZW50ICkge1xuXG4gIG1vdXNlWCA9ICggZXZlbnQuY2xpZW50WCAtIDY0MCApICogMTA7XG4gIG1vdXNlWSA9ICggZXZlbnQuY2xpZW50WSAtIDQ4MCApICogMTA7XG5cbn1cblxuZnVuY3Rpb24gYW5pbWF0ZSgpIHtcblxuICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoIGFuaW1hdGUgKTtcblxuICByZW5kZXIoKTtcblxufVxuXG5mdW5jdGlvbiByZW5kZXIoKSB7XG5cbiAgdmFyIHRpbWVyID0gMC4wMDAxICogRGF0ZS5ub3coKTtcblxuICBmb3IgKCB2YXIgaSA9IDAsIGlsID0gc3BoZXJlcy5sZW5ndGg7IGkgPCBpbDsgaSArKyApIHtcblxuICAgIHZhciBzcGhlcmUgPSBzcGhlcmVzWyBpIF07XG5cbiAgICBzcGhlcmUucG9zaXRpb24ueCA9IHJ4ICogTWF0aC5jb3MoIHRpbWVyICsgaSApO1xuICAgIHNwaGVyZS5wb3NpdGlvbi55ID0gcnkgKiBNYXRoLnNpbiggdGltZXIgKyBpICogMS4xICk7XG5cbiAgfVxuXG4gIGNhbWVyYS5wb3NpdGlvbi54ICs9ICggbW91c2VYIC0gY2FtZXJhLnBvc2l0aW9uLnggKSAqIDAuMDU7XG4gIGNhbWVyYS5wb3NpdGlvbi55ICs9ICggLSBtb3VzZVkgLSBjYW1lcmEucG9zaXRpb24ueSApICogMC4wNTtcblxuICBjYW1lcmEubG9va0F0KCBzY2VuZS5wb3NpdGlvbiApO1xuICBjYW1lcmFDdWJlLnJvdGF0aW9uLmNvcHkoIGNhbWVyYS5yb3RhdGlvbiApO1xuXG4gIHJlbmRlcmVyLnJlbmRlciggc2NlbmVDdWJlLCBjYW1lcmFDdWJlICk7XG4gIHJlbmRlcmVyLnJlbmRlciggc2NlbmUsIGNhbWVyYSApO1xuXG59XG5cblxuJChkb2N1bWVudCkub24oJ3JlYWR5Rm9yQ2FudmFzJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgY29uc29sZS5sb2coXCJyZWFkeUZvckNhbnZhc1wiKTtcbiAgaW5pdCgpO1xuICBhbmltYXRlKCk7XG4gICQoXCIjY2FudmFzXCIpLm9uKCAnbW91c2Vtb3ZlJywgb25Eb2N1bWVudE1vdXNlTW92ZSApO1xufSk7XG5cbiQoZG9jdW1lbnQpLm9uKCdyb3RhdGlvblZhbHVlQ2hhbmdlZCcsIGZ1bmN0aW9uKGV2ZW50LCB4LCB5KSB7XG4gIGNvbnNvbGUubG9nKCdyb3RhdGlvblZhbHVlQ2hhbmdlZDogJyArIHggKyAnLCAnICsgeSk7XG4gIHJ4ID0geDtcbiAgcnkgPSB5O1xufSk7XG4iLCJcbnZhciBjb250YWluZXI7XG5cbnZhciBjYW1lcmEsIHNjZW5lRmlyc3RQYXNzLCBzY2VuZVNlY29uZFBhc3MsIHJlbmRlcmVyO1xudmFyIHJ0VGV4dHVyZTtcbnZhciBjdWJlVGV4dHVyZTtcbnZhciB0cmFuc2ZlclRleHR1cmU7XG5cbnZhciBtYXRlcmlhbEZpcnN0UGFzcywgbWF0ZXJpYWxTZWNvbmRQYXNzO1xuXG52YXIgbWVzaCwgZ2VvbWV0cnk7XG52YXIgc3BoZXJlcyA9IFtdO1xuXG52YXIgdmVydGV4U2hhZGVyMSwgZnJhZ21lbnRTaGFkZXIxO1xudmFyIHZlcnRleFNoYWRlcjIsIGZyYWdtZW50U2hhZGVyMjtcblxudmFyIHNjcmVlblNpemUgPSB7eDogNjQwLCB5OiA0ODB9O1xudmFyIHdpbmRvd0hhbGZYID0gc2NyZWVuU2l6ZS54IC8gMjtcbnZhciB3aW5kb3dIYWxmWSA9IHNjcmVlblNpemUueSAvIDI7XG5cbmZ1bmN0aW9uIGxvYWRSZXNvdXJjZSh1cmwsIGNhbGxiYWNrKSB7XG4gICQuYWpheCh7XG4gICAgdXJsOiB1cmwsXG4gICAgc3VjY2VzczogZnVuY3Rpb24oZGF0YSkge1xuICAgICAgcmV0dXJuIGNhbGxiYWNrKG51bGwsIGRhdGEpO1xuICAgIH0sXG4gICAgZXJyb3I6IGZ1bmN0aW9uKGVycikge1xuICAgICAgcmV0dXJuIGNhbGxiYWNrKGVyciwgbnVsbCk7XG4gICAgfVxuICB9KTtcbn1cblxuLy8gTG9hZCBzaGFkZXJzXG5mdW5jdGlvbiBsb2FkU2hhZGVycygpIHtcbiAgY29uc29sZS5sb2coXCJIRUxMT1wiKTtcbiAgbG9hZFJlc291cmNlKCcvYXNzZXRzL3NoYWRlcnMvcmF5Y2FzdGVyLmZpcnN0cGFzcy52cycsIGZ1bmN0aW9uKGVyciwgZGF0YSkge1xuICAgIGlmKGVycikge1xuICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICB9XG4gICAgdmVydGV4U2hhZGVyMSA9IGRhdGE7XG5cbiAgICBsb2FkUmVzb3VyY2UoJy9hc3NldHMvc2hhZGVycy9yYXljYXN0ZXIuZmlyc3RwYXNzLmZzJywgZnVuY3Rpb24oZXJyLCBkYXRhKSB7XG4gICAgICBpZihlcnIpIHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgIH1cbiAgICAgIGZyYWdtZW50U2hhZGVyMSA9IGRhdGE7XG5cbiAgICAgIGxvYWRSZXNvdXJjZSgnL2Fzc2V0cy9zaGFkZXJzL3JheWNhc3Rlci5zZWNvbmRwYXNzLnZzJywgZnVuY3Rpb24oZXJyLCBkYXRhKSB7XG4gICAgICAgIGlmKGVycikge1xuICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgIH1cbiAgICAgICAgdmVydGV4U2hhZGVyMiA9IGRhdGE7XG5cbiAgICAgICAgbG9hZFJlc291cmNlKCcvYXNzZXRzL3NoYWRlcnMvcmF5Y2FzdGVyLnNlY29uZHBhc3MuZnMnLCBmdW5jdGlvbihlcnIsIGRhdGEpIHtcbiAgICAgICAgICBpZihlcnIpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgICAgfVxuICAgICAgICAgIGZyYWdtZW50U2hhZGVyMiA9IGRhdGE7XG4gICAgICAgICAgaW5pdCgpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcbn1cblxuXG5mdW5jdGlvbiBpbml0KCkge1xuXG4gIGNvbnRhaW5lciA9ICQoJyNtYWluJyk7XG5cbiAgY2FtZXJhID0gbmV3IFRIUkVFLlBlcnNwZWN0aXZlQ2FtZXJhKCA2MCwgc2NyZWVuU2l6ZS54L3NjcmVlblNpemUueSwgMC4xLCAxMDAwMDAgKTtcbiAgY2FtZXJhLnBvc2l0aW9uLnogPSAyO1xuXG4gIHNjZW5lRmlyc3RQYXNzID0gbmV3IFRIUkVFLlNjZW5lKCk7XG5cdHNjZW5lU2Vjb25kUGFzcyA9IG5ldyBUSFJFRS5TY2VuZSgpO1xuXG4gIGN1YmVUZXh0dXJlID0gVEhSRUUuSW1hZ2VVdGlscy5sb2FkVGV4dHVyZSgnL2Fzc2V0cy9pbWFnZXMvYm9uc2FpLnJhdy5wbmcnICk7XG4gIGN1YmVUZXh0dXJlLmdlbmVyYXRlTWlwbWFwcyA9IGZhbHNlO1xuICBjdWJlVGV4dHVyZS5taW5GaWx0ZXIgPSBUSFJFRS5MaW5lYXJGaWx0ZXI7XG4gIGN1YmVUZXh0dXJlLm1hZ0ZpbHRlciA9IFRIUkVFLkxpbmVhckZpbHRlcjtcblxuICB0cmFuc2ZlclRleHR1cmUgPSB1cGRhdGVUcmFuc2ZlckZ1bmN0aW9uKCk7XG5cbiAgcnRUZXh0dXJlID0gbmV3IFRIUkVFLldlYkdMUmVuZGVyVGFyZ2V0KCBzY3JlZW5TaXplLngsIHNjcmVlblNpemUueSxcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR7IFx0bWluRmlsdGVyOiBUSFJFRS5MaW5lYXJGaWx0ZXIsXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRtYWdGaWx0ZXI6IFRIUkVFLkxpbmVhckZpbHRlcixcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHdyYXBTOiAgVEhSRUUuQ2xhbXBUb0VkZ2VXcmFwcGluZyxcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHdyYXBUOiAgVEhSRUUuQ2xhbXBUb0VkZ2VXcmFwcGluZyxcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGZvcm1hdDogVEhSRUUuUkdCRm9ybWF0LFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0dHlwZTogVEhSRUUuRmxvYXRUeXBlLFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Z2VuZXJhdGVNaXBtYXBzOiBmYWxzZX0gKTtcblxuXG4gIG1hdGVyaWFsRmlyc3RQYXNzID0gbmV3IFRIUkVFLlNoYWRlck1hdGVyaWFsKCB7XG4gIFx0dmVydGV4U2hhZGVyOiB2ZXJ0ZXhTaGFkZXIxLFxuICBcdGZyYWdtZW50U2hhZGVyOiBmcmFnbWVudFNoYWRlcjEsXG4gIFx0c2lkZTogVEhSRUUuQmFja1NpZGVcbiAgfSApO1xuXG5cdG1hdGVyaWFsU2Vjb25kUGFzcyA9IG5ldyBUSFJFRS5TaGFkZXJNYXRlcmlhbCgge1xuICBcdHZlcnRleFNoYWRlcjogdmVydGV4U2hhZGVyMixcbiAgXHRmcmFnbWVudFNoYWRlcjogZnJhZ21lbnRTaGFkZXIyLFxuXHRcdHNpZGU6IFRIUkVFLkZyb250U2lkZSxcblx0XHR1bmlmb3Jtczoge1xuICAgICAgdGV4OiAge1xuICAgICAgICB0eXBlOiBcInRcIixcbiAgICAgICAgdmFsdWU6IHJ0VGV4dHVyZVxuICAgICAgfSxcblx0XHRcdGN1YmVUZXg6XG4gICAgICB7XG4gICAgICAgIHR5cGU6IFwidFwiLFxuICAgICAgICB2YWx1ZTogY3ViZVRleHR1cmVcbiAgICAgIH0sXG5cdFx0XHR0cmFuc2ZlclRleDpcbiAgICAgIHtcbiAgICAgICAgdHlwZTogXCJ0XCIsXG4gICAgICAgIHZhbHVlOiB0cmFuc2ZlclRleHR1cmVcbiAgICAgIH0sXG5cdFx0XHRzdGVwcyA6IHtcbiAgICAgICAgdHlwZTogXCIxZlwiICxcbiAgICAgICAgdmFsdWU6IDI1NlxuICAgICAgfSxcblx0XHRcdGFscGhhQ29ycmVjdGlvbiA6IHtcbiAgICAgICAgdHlwZTogXCIxZlwiICxcbiAgICAgICAgdmFsdWU6IDEuMFxuICAgICAgfVxuICAgIH1cblx0IH0pO1xuXG5cbiAgLy8gR2VvbWV0cnkgc2V0dXBcblx0dmFyIGJveEdlb21ldHJ5ID0gbmV3IFRIUkVFLkJveEdlb21ldHJ5KDEuMCwgMS4wLCAxLjApO1xuXHRib3hHZW9tZXRyeS5kb3VibGVTaWRlZCA9IHRydWU7XG5cdHZhciBtZXNoRmlyc3RQYXNzID0gbmV3IFRIUkVFLk1lc2goIGJveEdlb21ldHJ5LCBtYXRlcmlhbEZpcnN0UGFzcyApO1xuXHR2YXIgbWVzaFNlY29uZFBhc3MgPSBuZXcgVEhSRUUuTWVzaCggYm94R2VvbWV0cnksIG1hdGVyaWFsU2Vjb25kUGFzcyApO1xuXHRzY2VuZUZpcnN0UGFzcy5hZGQoIG1lc2hGaXJzdFBhc3MgKTtcblx0c2NlbmVTZWNvbmRQYXNzLmFkZCggbWVzaFNlY29uZFBhc3MgKTtcblxuXG4gIHJlbmRlcmVyID0gbmV3IFRIUkVFLldlYkdMUmVuZGVyZXIoKTtcbiAgcmVuZGVyZXIuc2V0UGl4ZWxSYXRpbyggd2luZG93LmRldmljZVBpeGVsUmF0aW8gKTtcbiAgcmVuZGVyZXIuc2V0U2l6ZSggc2NyZWVuU2l6ZS54LCBzY3JlZW5TaXplLnkgKTtcbiAgcmVuZGVyZXIuYXV0b0NsZWFyID0gdHJ1ZTtcbiAgcmVuZGVyZXIuc2V0Q2xlYXJDb2xvcihcIiNGRkZGRkZcIik7XG4gIGNvbnNvbGUubG9nKFwiY2xlYXIgY29sb3I6IFwiKTtcbiAgY29uc29sZS5sb2cocmVuZGVyZXIuZ2V0Q2xlYXJDb2xvcigpKTtcbiAgcmVuZGVyZXIuZG9tRWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2lkJywgJ2NhbnZhcycpO1xuICBjb250YWluZXIuYXBwZW5kKCByZW5kZXJlci5kb21FbGVtZW50ICk7XG5cbiAgdmFyIGIgPSBuZXcgVEhSRUUuQm94R2VvbWV0cnkoMiwyLDIpO1xuICB2YXIgYm1hdCA9IG5ldyBUSFJFRS5NZXNoQmFzaWNNYXRlcmlhbCh7Y29sb3I6IFwiI0ZGMDAwMFwifSk7XG5cbiAgdmFyIGJtZXNoID0gbmV3IFRIUkVFLk1lc2goYiwgYm1hdCk7XG4gIGJtZXNoLnBvc2l0aW9uLnggPSAwO1xuICBibWVzaC5wb3NpdGlvbi55ID0gMDtcbiAgYm1lc2gucG9zaXRpb24ueiA9IDA7XG5cbiAgLy9zY2VuZVNlY29uZFBhc3MuYWRkKGJtZXNoKTtcblxuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lciggJ3Jlc2l6ZScsIG9uV2luZG93UmVzaXplLCBmYWxzZSApO1xuXG4gIGFuaW1hdGUoKTtcbn1cblxuZnVuY3Rpb24gb25XaW5kb3dSZXNpemUoKSB7XG5cbiAgd2luZG93SGFsZlggPSBzY3JlZW5TaXplLnggLyAyO1xuICB3aW5kb3dIYWxmWSA9IHNjcmVlblNpemUueSAvIDI7XG5cbiAgY2FtZXJhLmFzcGVjdCA9IHNjcmVlblNpemUueC9zY3JlZW5TaXplLnk7XG4gIGNhbWVyYS51cGRhdGVQcm9qZWN0aW9uTWF0cml4KCk7XG5cbiAgcmVuZGVyZXIuc2V0U2l6ZSggc2NyZWVuU2l6ZS54LCBzY3JlZW5TaXplLnkgKTtcblxufVxuXG5cbmZ1bmN0aW9uIGFuaW1hdGUoKSB7XG5cbiAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCBhbmltYXRlICk7XG5cbiAgcmVuZGVyKCk7XG5cbn1cblxuZnVuY3Rpb24gcmVuZGVyKCkge1xuXG4gIC8vdmFyIGRlbHRhID0gY2xvY2suZ2V0RGVsdGEoKTtcblx0Ly9SZW5kZXIgZmlyc3QgcGFzcyBhbmQgc3RvcmUgdGhlIHdvcmxkIHNwYWNlIGNvb3JkcyBvZiB0aGUgYmFjayBmYWNlIGZyYWdtZW50cyBpbnRvIHRoZSB0ZXh0dXJlLlxuXHRyZW5kZXJlci5yZW5kZXIoIHNjZW5lRmlyc3RQYXNzLCBjYW1lcmEsIHJ0VGV4dHVyZSwgdHJ1ZSApO1xuXHQvL1JlbmRlciB0aGUgc2Vjb25kIHBhc3MgYW5kIHBlcmZvcm0gdGhlIHZvbHVtZSByZW5kZXJpbmcuXG5cdHJlbmRlcmVyLnJlbmRlciggc2NlbmVTZWNvbmRQYXNzLCBjYW1lcmEgKTtcblx0bWF0ZXJpYWxTZWNvbmRQYXNzLnVuaWZvcm1zLnN0ZXBzLnZhbHVlID0gMjU2O1xuXHRtYXRlcmlhbFNlY29uZFBhc3MudW5pZm9ybXMuYWxwaGFDb3JyZWN0aW9uLnZhbHVlID0gMS4wO1xuXG59XG5cbmZ1bmN0aW9uIHVwZGF0ZVRleHR1cmVzKHZhbHVlKSB7XG4gIG1hdGVyaWFsU2Vjb25kUGFzcy51bmlmb3Jtcy50cmFuc2ZlclRleC52YWx1ZSA9IHVwZGF0ZVRyYW5zZmVyRnVuY3Rpb24oKTtcbn1cblxuZnVuY3Rpb24gdXBkYXRlVHJhbnNmZXJGdW5jdGlvbigpIHtcblx0dmFyIGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xuXHRjYW52YXMuaGVpZ2h0ID0gMjA7XG5cdGNhbnZhcy53aWR0aCA9IDI1Njtcblx0dmFyIGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuXHR2YXIgZ3JkID0gY3R4LmNyZWF0ZUxpbmVhckdyYWRpZW50KDAsIDAsIGNhbnZhcy53aWR0aCAtMSAsIGNhbnZhcy5oZWlnaHQgLSAxKTtcblx0Z3JkLmFkZENvbG9yU3RvcCgwLjEsIFwiIzAwRkYwMFwiKTtcblx0Z3JkLmFkZENvbG9yU3RvcCgwLjcsIFwiI0ZGMDAwMFwiKTtcblx0Z3JkLmFkZENvbG9yU3RvcCgxLjAsIFwiIzAwMDBGRlwiKTtcblx0Y3R4LmZpbGxTdHlsZSA9IGdyZDtcblx0Y3R4LmZpbGxSZWN0KDAsMCxjYW52YXMud2lkdGggLTEgLGNhbnZhcy5oZWlnaHQgLTEgKTtcblxuICB2YXIgaW1nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0cmFuc2ZlclRleHR1cmVcIik7XG5cdFx0XHRcdGltZy5zcmMgPSBjYW52YXMudG9EYXRhVVJMKCk7XG5cdFx0XHRcdGltZy5zdHlsZS53aWR0aCA9IFwiMjU2IHB4XCI7XG5cdFx0XHRcdGltZy5zdHlsZS5oZWlnaHQgPSBcIjEyOCBweFwiO1xuXG5cdHRyYW5zZmVyVGV4dHVyZSA9ICBuZXcgVEhSRUUuVGV4dHVyZShjYW52YXMpO1xuXHR0cmFuc2ZlclRleHR1cmUud3JhcFMgPSB0cmFuc2ZlclRleHR1cmUud3JhcFQgPSAgVEhSRUUuQ2xhbXBUb0VkZ2VXcmFwcGluZztcblx0dHJhbnNmZXJUZXh0dXJlLm5lZWRzVXBkYXRlID0gdHJ1ZTtcblx0cmV0dXJuIHRyYW5zZmVyVGV4dHVyZTtcbn1cblxuXG4kKGRvY3VtZW50KS5vbigncmVhZHlGb3JDYW52YXNSYXljYXN0ZXInLCBmdW5jdGlvbihldmVudCkge1xuICBjb25zb2xlLmxvZyhcInJlYWR5Rm9yQ2FudmFzUmF5Y2FzdGVyXCIpO1xuICBsb2FkU2hhZGVycygpO1xuICAkKFwiI2NhbnZhc1wiKS5vbiggJ21vdXNlbW92ZScsIG9uRG9jdW1lbnRNb3VzZU1vdmUgKTtcbn0pO1xuXG4kKGRvY3VtZW50KS5vbigncm90YXRpb25WYWx1ZUNoYW5nZWQnLCBmdW5jdGlvbihldmVudCwgeCwgeSkge1xuICBjb25zb2xlLmxvZygncm90YXRpb25WYWx1ZUNoYW5nZWQ6ICcgKyB4ICsgJywgJyArIHkpO1xuICByeCA9IHg7XG4gIHJ5ID0geTtcbn0pO1xuIiwiXG4ndXNlIHN0cmljdCc7XG5cbnZhciBtYWluID0gYW5ndWxhci5tb2R1bGUoJ2N0TWFpbicsIFtdKTtcblxubWFpbi5jb250cm9sbGVyKCdNYWluQ29udHJvbGxlcicsIFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKSB7XG4gICQoZG9jdW1lbnQpLnRyaWdnZXIoJ3JlYWR5Rm9yQ2FudmFzUmF5Y2FzdGVyJyk7XG5cbiAgJHNjb3BlLnVwZGF0ZVJvdGF0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgY29uc29sZS5sb2coXCJvbkNsaWNrUm90YXRpb25DaGFuZ2VkXCIpO1xuICAgICQoZG9jdW1lbnQpLnRyaWdnZXIoJ3JvdGF0aW9uVmFsdWVDaGFuZ2VkJywgW3BhcnNlSW50KCRzY29wZS5yb3RhdGlvbi54KSwgcGFyc2VJbnQoJHNjb3BlLnJvdGF0aW9uLnkpXSk7XG4gIH07XG5cbiAgdmFyIHJhbmRvbWRhdGEgPSBbXTtcbiAgZm9yKCB2YXIgaSA9IDA7IGkgPCAyMDsgaSsrKSB7XG4gICAgcmFuZG9tZGF0YVtpXSA9IFtdO1xuICAgIGZvciggdmFyIGogPSAwOyBqIDwgMTAwOyBqKyspIHtcbiAgICAgIHJhbmRvbWRhdGFbaV1bal0gPSBbXTtcbiAgICAgIGZvciggdmFyIGsgPSAwOyBrIDwgMTAwOyBrKyspIHtcbiAgICAgICAgcmFuZG9tZGF0YVtpXVtqXS5wdXNoKE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSo0MDk2KSk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGNvbnNvbGUubG9nKFwiSGVsbG8gbW9zYWljXCIpO1xuICAkKFwiI3Rlc3RcIikuYXBwZW5kKG1vc2FpYy5jcmVhdGVNb3NhaWNJbWFnZSgxMDAsIDEwMCwgcmFuZG9tZGF0YSkpO1xufV0pO1xuIiwidmFyIG1vc2FpYyA9IHt9O1xuXG5tb3NhaWMuY3JlYXRlT25lSW1hZ2UgPSBmdW5jdGlvbihzaXpleCwgc2l6ZXksIGRhdGEpIHtcblx0dmFyIGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIik7XG5cdGNhbnZhcy5zZXRBdHRyaWJ1dGUoXCJ3aWR0aFwiLCBzaXpleCk7XG5cdGNhbnZhcy5zZXRBdHRyaWJ1dGUoXCJoZWlnaHRcIiwgc2l6ZXkpO1xuXHR2YXIgY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7XG5cdGNvbnNvbGUubG9nKFwib25lIGltZyBkYXRhIGxlbmd0aDogXCIgKyBkYXRhLmxlbmd0aCk7XG5cblx0Zm9yKHZhciBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcblx0XHRmb3IodmFyIGogPSAwOyBqIDwgZGF0YVswXS5sZW5ndGg7IGorKykge1xuXHRcdFx0dmFyIGlkID0gY3R4LmNyZWF0ZUltYWdlRGF0YSgxLDEpO1xuXHRcdFx0Ly8gVXNlIGJpdG1hc2sgZm9yIHNwbGl0aW5nIHRoZSB1aW50MTYgdmFsdWUgaW50byB0d28gdWludDggdG8gZml0IGludG8gaW1nXG5cdFx0XHRpZC5kYXRhWzBdID0gZGF0YVtpXVtqXSAmIDB4RkYwMDtcdC8vIHJcblx0XHRcdGlkLmRhdGFbMV0gPSBkYXRhW2ldW2pdICYgMHgwMEZGO1x0Ly8gZ1xuXHRcdFx0aWQuZGF0YVsyXSA9IDA7XHQvLyBiXG5cdFx0XHRpZC5kYXRhWzNdID0gMjU1O1x0Ly8gYVxuXHRcdFx0Y3R4LnB1dEltYWdlRGF0YShpZCwgaiwgaSk7IC8vIHJvdyBiYXNlZCwgc28gYWRkIHRvIHg9aiwgeT1pXG5cdFx0Ly9cdGNvbnNvbGUubG9nKFwiUjogXCIgKyBwWzBdICsgXCIgRzpcIiArIHBbMV0pO1xuXHRcdH1cblx0fVxuXG5cdHZhciBpbWFnZSA9IG5ldyBJbWFnZSgpO1xuXHRpbWFnZS5zcmMgPSBjYW52YXMudG9EYXRhVVJMKFwiL2ltYWdlL3BuZ1wiKTtcblx0cmV0dXJuIGltYWdlO1xufVxuXG5tb3NhaWMuY3JlYXRlTW9zYWljSW1hZ2UgPSBmdW5jdGlvbihzaXpleCwgc2l6ZXksIGRhdGEpIHtcblx0dmFyIGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIik7XG5cdGNhbnZhcy5zZXRBdHRyaWJ1dGUoXCJ3aWR0aFwiLCBkYXRhWzBdLmxlbmd0aCpzaXpleCk7XG5cdGNhbnZhcy5zZXRBdHRyaWJ1dGUoXCJoZWlnaHRcIiwgc2l6ZXkpO1xuXHR2YXIgY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7XG5cdHZhciBpbWdhcnIgPSBbXTtcblx0Zm9yKHZhciBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcblx0XHRjb25zb2xlLmxvZyhcImRhdGFbaV06IFwiICsgZGF0YVtpXS5sZW5ndGgpO1xuXHRcdGltZ2Fyci5wdXNoKHRoaXMuY3JlYXRlT25lSW1hZ2Uoc2l6ZXgsIHNpemV5LCBkYXRhW2ldKSk7XG5cdFx0Y3R4LmRyYXdJbWFnZShpbWdhcnJbaV0sIHNpemV4KmksIDAsIHNpemV4LCBzaXpleSk7XG5cdH1cblx0dmFyIGltZyA9IG5ldyBJbWFnZSgpO1xuXHRpbWcuc3JjID0gY2FudmFzLnRvRGF0YVVSTChcIi9pbWFnZS9wbmdcIik7XG5cdGNvbnNvbGUubG9nKFwiRmluaXNoZWQgcmVhZGluZyBhbmQgY3JlYXRpbmcgaW1nXCIpO1xuXHRyZXR1cm4gaW1nO1xufVxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
